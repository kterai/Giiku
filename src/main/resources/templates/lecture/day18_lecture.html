<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ITエンジニア育成カリキュラム - Day18: データベース接続（JDBC）基礎</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Hiragino Sans', 'Yu Gothic', 'Meiryo', sans-serif;
            line-height: 1.7;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .section-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            margin: 25px 0 15px 0;
        }
        .content-box {
            background-color: #f9f9f9;
            border-left: 4px solid #28a745;
            padding: 15px 20px;
            margin: 15px 0;
        }
        .warning-box {
            background-color: #fff5f5;
            border: 2px solid #e53e3e;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        .info-box {
            background-color: #e6f3ff;
            border: 2px solid #2196f3;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        .success-box {
            background-color: #f0fff4;
            border: 2px solid #4caf50;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        .code-example {
            background-color: #f8f8f8;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 12px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            overflow-x: auto;
        }
        .quiz-container {
            background-color: #fff9e6;
            border: 2px solid #ff9800;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .exercise-container {
            background-color: #f0f8ff;
            border: 2px solid #4a90e2;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .answer-section {
            background-color: #e8f5e8;
            border: 1px solid #4caf50;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
            display: none;
        }
        .btn-show-answer {
            background-color: #2196f3;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .btn-show-answer:hover {
            background-color: #1976d2;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        .highlight {
            background-color: #ffeb3b;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .jdbc-flow {
            background: linear-gradient(90deg, #e3f2fd 0%, #bbdefb 50%, #90caf9 100%);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .fixed-nav {
            backdrop-filter: blur(10px);
            background-color: rgba(255, 255, 255, 0.95);
        }
        .nav-link:hover {
            background-color: rgba(59, 130, 246, 0.1);
        }
        .breadcrumb-separator::after {
            content: ">";
            margin: 0 8px;
            color: #9CA3AF;
        }
    </style>
</head>
<body class="bg-gray-50">
    <nav class="fixed top-0 left-0 right-0 z-50 fixed-nav border-b border-gray-200">
        <div class="bg-blue-600 text-white">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-12">
                    <div class="flex items-center">
                        <i class="fas fa-graduation-cap mr-2"></i>
                        <span class="font-semibold">ITエンジニア育成カリキュラム</span>
                    </div>
                    <div class="flex items-center space-x-4">
                        <a href="./day17_lecture.html" class="nav-link px-3 py-1 rounded text-sm hover:bg-blue-700 transition-colors">
                            <i class="fas fa-chevron-left mr-1"></i> 前の講義
                        </a>
                        <a href="./day19_lecture.html" class="nav-link px-3 py-1 rounded text-sm hover:bg-blue-700 transition-colors">
                            次の講義 <i class="fas fa-chevron-right ml-1"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="bg-white px-4 py-3">
            <div class="max-w-7xl mx-auto">
                <div class="flex items-center justify-between">
                    <div class="flex items-center text-sm text-gray-600">
                        <a href="../../index.html" class="hover:text-blue-600"><i class="fas fa-home mr-1"></i>ホーム</a>
                        <span class="breadcrumb-separator"></span>
                        <a href="../month/month1.html" class="hover:text-blue-600">1ヶ月目: Java基礎</a>
                        <span class="breadcrumb-separator"></span>
                        <a href="../week/week4.html" class="hover:text-blue-600">4週目: 総仕上げ</a>
                        <span class="breadcrumb-separator"></span>
                        <span class="font-semibold text-blue-600">18日目: データベース接続（JDBC）基礎</span>
                    </div>
                    <div class="flex items-center space-x-3">
                        <a href="../day/day18.html" class="inline-flex items-center px-3 py-1 border border-blue-300 rounded-md text-sm text-blue-600 hover:bg-blue-50 transition-colors">
                            <i class="fas fa-clipboard-list mr-1"></i> 本日の概要
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    <main class="pt-32">
    <header class="bg-blue-800 text-white py-4 shadow-lg">
        <div class="container mx-auto px-4">
            <h1 class="text-2xl md:text-3xl font-bold text-center mb-2">
                <i class="fas fa-database mr-3"></i>
                Day18: データベース接続（JDBC）基礎
            </h1>
            <p class="text-center text-blue-200 text-lg">Java Database Connectivity - データベースとJavaアプリケーションの連携</p>
            <div class="mt-3 text-center text-sm">
                <span class="bg-blue-700 px-3 py-1 rounded-full mr-2">所要時間: 6時間</span>
                <span class="bg-blue-700 px-3 py-1 rounded-full mr-2">対象: 初級～中級</span>
                <span class="bg-blue-700 px-3 py-1 rounded-full">JavaSilver試験対応</span>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-4 py-8">
        <!-- 学習目標 -->
        <div class="section-header">
            <h2 class="text-2xl font-bold">
                <i class="fas fa-bullseye"></i> 本日の学習目標
            </h2>
        </div>

        <div class="content-box">
            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <h3 class="text-lg font-semibold text-green-700 mb-3">
                        <i class="fas fa-check-circle"></i> 知識目標
                    </h3>
                    <ul class="space-y-2">
                        <li>✅ JDBC（Java Database Connectivity）の概念と仕組みを理解</li>
                        <li>✅ データベースドライバーの役割と使用方法を習得</li>
                        <li>✅ SQL文の実行方法（SELECT、INSERT、UPDATE、DELETE）</li>
                        <li>✅ ResultSetを使用したデータ取得と処理方法</li>
                        <li>✅ コネクション管理とリソース解放の重要性</li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold text-blue-700 mb-3">
                        <i class="fas fa-tools"></i> 実践スキル
                    </h3>
                    <ul class="space-y-2">
                        <li>🔧 JDBCドライバーの設定と接続確立</li>
                        <li>🔧 PreparedStatementを使用した安全なSQL実行</li>
                        <li>🔧 トランザクション制御の実装</li>
                        <li>🔧 例外処理とエラーハンドリング</li>
                        <li>🔧 データベースアプリケーションの設計パターン</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- スケジュール -->
        <div class="section-header">
            <h2 class="text-2xl font-bold">
                <i class="fas fa-calendar"></i> 講義スケジュール
            </h2>
        </div>

        <div class="content-box">
            <table>
                <thead>
                    <tr>
                        <th>時間</th>
                        <th>内容</th>
                        <th>実習・演習</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>10:00-10:15</td>
                        <td>前日復習・本日の目標確認</td>
                        <td>I/Oストリームの復習クイズ</td>
                    </tr>
                    <tr>
                        <td>10:15-11:15</td>
                        <td>JDBC概要・データベース基礎知識</td>
                        <td>MySQL/H2データベース環境構築</td>
                    </tr>
                    <tr>
                        <td>11:15-12:15</td>
                        <td>JDBC接続とSQL基本操作</td>
                        <td>データベース接続プログラム作成</td>
                    </tr>
                    <tr>
                        <td>12:15-13:15</td>
                        <td>昼休憩</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td>13:15-14:15</td>
                        <td>PreparedStatementとResultSet</td>
                        <td>データ検索・挿入プログラム実装</td>
                    </tr>
                    <tr>
                        <td>14:15-15:15</td>
                        <td>トランザクション制御と例外処理</td>
                        <td>銀行口座システム模擬開発</td>
                    </tr>
                    <tr>
                        <td>15:15-16:00</td>
                        <td>データベース設計パターン・DAO</td>
                        <td>設計パターン実装演習</td>
                    </tr>
                    <tr>
                        <td>16:00-16:30</td>
                        <td>総合演習・理解度クイズ</td>
                        <td>顧客管理システム作成</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- メイン講義 -->
        <div class="section-header">
            <h2 class="text-2xl font-bold">
                <i class="fas fa-book-open"></i> メイン講義
            </h2>
        </div>

        <!-- 1. JDBC概要 -->
        <div class="content-box">
            <h3 class="text-xl font-semibold mb-4">
                <i class="fas fa-info-circle text-blue-600"></i> 1. JDBC（Java Database Connectivity）とは
            </h3>
            
            <div class="info-box">
                <h4 class="text-lg font-semibold text-blue-700 mb-2">📚 専門用語の詳細解説</h4>
                <ul class="space-y-2">
                    <li><span class="highlight">JDBC</span>: Java Database Connectivity - Javaアプリケーションからデータベースにアクセスするための標準API</li>
                    <li><span class="highlight">データベースドライバー</span>: 特定のデータベース（MySQL、Oracle等）と通信するためのソフトウェア部品</li>
                    <li><span class="highlight">Connection（コネクション）</span>: データベースとの接続を表現するオブジェクト</li>
                    <li><span class="highlight">SQL</span>: Structured Query Language - データベースを操作するための言語</li>
                    <li><span class="highlight">ResultSet</span>: SELECT文の実行結果を格納するオブジェクト</li>
                </ul>
            </div>

            <div class="jdbc-flow">
                <h4 class="text-lg font-semibold mb-3">🔄 JDBC処理の流れ</h4>
                <div class="flex flex-wrap items-center justify-center space-x-4">
                    <div class="bg-white p-3 rounded-lg shadow text-center m-2">
                        <i class="fas fa-plug text-green-600 text-2xl mb-2"></i>
                        <p class="font-semibold">1. ドライバー読み込み</p>
                    </div>
                    <i class="fas fa-arrow-right text-blue-600"></i>
                    <div class="bg-white p-3 rounded-lg shadow text-center m-2">
                        <i class="fas fa-handshake text-blue-600 text-2xl mb-2"></i>
                        <p class="font-semibold">2. データベース接続</p>
                    </div>
                    <i class="fas fa-arrow-right text-blue-600"></i>
                    <div class="bg-white p-3 rounded-lg shadow text-center m-2">
                        <i class="fas fa-terminal text-purple-600 text-2xl mb-2"></i>
                        <p class="font-semibold">3. SQL文実行</p>
                    </div>
                    <i class="fas fa-arrow-right text-blue-600"></i>
                    <div class="bg-white p-3 rounded-lg shadow text-center m-2">
                        <i class="fas fa-table text-orange-600 text-2xl mb-2"></i>
                        <p class="font-semibold">4. 結果処理</p>
                    </div>
                    <i class="fas fa-arrow-right text-blue-600"></i>
                    <div class="bg-white p-3 rounded-lg shadow text-center m-2">
                        <i class="fas fa-times-circle text-red-600 text-2xl mb-2"></i>
                        <p class="font-semibold">5. 接続終了</p>
                    </div>
                </div>
            </div>

            <div class="code-example">
                <h4 class="font-semibold mb-2">JDBC基本構造の例</h4>
                <pre><code class="language-java">
// 1. 必要なパッケージをimport
import java.sql.*;

public class JDBCSample {
    public static void main(String[] args) {
        // データベース接続情報
        String url = "jdbc:mysql://localhost:3306/sampledb";
        String user = "username";
        String password = "password";
        
        try {
            // 2. データベースに接続
            Connection conn = DriverManager.getConnection(url, user, password);
            
            // 3. SQL文を準備・実行
            String sql = "SELECT * FROM users";
            Statement stmt = conn.createStatement();
            ResultSet rs = stmt.executeQuery(sql);
            
            // 4. 結果を処理
            while (rs.next()) {
                System.out.println("ID: " + rs.getInt("id"));
                System.out.println("名前: " + rs.getString("name"));
            }
            
            // 5. リソースを解放
            rs.close();
            stmt.close();
            conn.close();
            
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}
                </code></pre>
            </div>
        </div>

        <!-- 2. データベース接続 -->
        <div class="content-box">
            <h3 class="text-xl font-semibold mb-4">
                <i class="fas fa-link text-green-600"></i> 2. データベース接続の詳細
            </h3>

            <div class="info-box">
                <h4 class="text-lg font-semibold text-blue-700 mb-2">🔌 接続URL（Connection URL）の構造</h4>
                <p class="mb-2">データベースの場所と設定を指定する文字列です：</p>
                <div class="code-example">
                    <p><strong>MySQL:</strong> jdbc:mysql://ホスト名:ポート番号/データベース名</p>
                    <p><strong>H2:</strong> jdbc:h2:mem:testdb （メモリ内データベース）</p>
                    <p><strong>PostgreSQL:</strong> jdbc:postgresql://ホスト名:ポート番号/データベース名</p>
                </div>
            </div>

            <div class="warning-box">
                <h4 class="text-lg font-semibold text-red-700 mb-2">⚠️ 接続時の注意点</h4>
                <ul class="space-y-2">
                    <li><strong>ドライバーの追加：</strong> プロジェクトにJDBCドライバーのJARファイルを追加する必要があります</li>
                    <li><strong>例外処理：</strong> データベース接続はSQLExceptionをthrowするため、try-catch文が必須です</li>
                    <li><strong>リソース管理：</strong> 接続は必ず閉じる必要があります（メモリリークを防ぐため）</li>
                </ul>
            </div>

            <div class="code-example">
                <h4 class="font-semibold mb-2">try-with-resources文を使用した安全な接続管理</h4>
                <pre><code class="language-java">
public class DatabaseConnectionExample {
    private static final String URL = "jdbc:h2:mem:testdb";
    private static final String USER = "sa";
    private static final String PASSWORD = "";
    
    public static void connectToDatabase() {
        // try-with-resources文により自動的にリソースが解放される
        try (Connection conn = DriverManager.getConnection(URL, USER, PASSWORD)) {
            
            System.out.println("データベースに正常に接続しました");
            
            // データベースの情報を取得
            DatabaseMetaData metaData = conn.getMetaData();
            System.out.println("データベース製品名: " + metaData.getDatabaseProductName());
            System.out.println("バージョン: " + metaData.getDatabaseProductVersion());
            
        } catch (SQLException e) {
            System.err.println("データベース接続エラー: " + e.getMessage());
            e.printStackTrace();
        }
    }
}
                </code></pre>
            </div>
        </div>

        <!-- 3. SQL文の実行 -->
        <div class="content-box">
            <h3 class="text-xl font-semibold mb-4">
                <i class="fas fa-play text-purple-600"></i> 3. SQL文の実行方法
            </h3>

            <div class="info-box">
                <h4 class="text-lg font-semibold text-blue-700 mb-2">📊 StatementとPreparedStatementの比較</h4>
                <table>
                    <thead>
                        <tr>
                            <th>項目</th>
                            <th>Statement</th>
                            <th>PreparedStatement</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>SQL文の準備</td>
                            <td>実行時に文字列結合</td>
                            <td>事前にコンパイル済み</td>
                        </tr>
                        <tr>
                            <td>パフォーマンス</td>
                            <td>低い（毎回解析）</td>
                            <td>高い（再利用可能）</td>
                        </tr>
                        <tr>
                            <td>SQLインジェクション対策</td>
                            <td>脆弱</td>
                            <td>安全（パラメータ化）</td>
                        </tr>
                        <tr>
                            <td>使用場面</td>
                            <td>動的SQL・一回限りの実行</td>
                            <td>繰り返し実行・ユーザー入力あり</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="success-box">
                <h4 class="text-lg font-semibold text-green-700 mb-2">✅ PreparedStatementを使用する理由</h4>
                <ul class="space-y-2">
                    <li><strong>セキュリティ：</strong> SQLインジェクション攻撃を防止</li>
                    <li><strong>パフォーマンス：</strong> SQL文の再利用により高速化</li>
                    <li><strong>可読性：</strong> パラメータ設定により見やすいコード</li>
                    <li><strong>型安全性：</strong> 適切なデータ型での値設定</li>
                </ul>
            </div>

            <div class="code-example">
                <h4 class="font-semibold mb-2">PreparedStatementの使用例</h4>
                <pre><code class="language-java">
public class PreparedStatementExample {
    
    // データ挿入メソッド
    public static void insertUser(Connection conn, String name, int age, String email) {
        String sql = "INSERT INTO users (name, age, email) VALUES (?, ?, ?)";
        
        try (PreparedStatement pstmt = conn.prepareStatement(sql)) {
            // パラメータを設定（?の順番に対応）
            pstmt.setString(1, name);    // 1番目の?にname
            pstmt.setInt(2, age);        // 2番目の?にage  
            pstmt.setString(3, email);   // 3番目の?にemail
            
            // SQL文を実行
            int rowsAffected = pstmt.executeUpdate();
            System.out.println(rowsAffected + "件のレコードを挿入しました");
            
        } catch (SQLException e) {
            System.err.println("データ挿入エラー: " + e.getMessage());
        }
    }
    
    // データ検索メソッド
    public static void searchUsersByAge(Connection conn, int minAge) {
        String sql = "SELECT id, name, age, email FROM users WHERE age >= ?";
        
        try (PreparedStatement pstmt = conn.prepareStatement(sql)) {
            pstmt.setInt(1, minAge);
            
            ResultSet rs = pstmt.executeQuery();
            
            System.out.println("年齢" + minAge + "歳以上のユーザー:");
            while (rs.next()) {
                System.out.printf("ID: %d, 名前: %s, 年齢: %d, メール: %s%n",
                    rs.getInt("id"),
                    rs.getString("name"), 
                    rs.getInt("age"),
                    rs.getString("email"));
            }
            
        } catch (SQLException e) {
            System.err.println("データ検索エラー: " + e.getMessage());
        }
    }
}
                </code></pre>
            </div>
        </div>

        <!-- 4. ResultSetの使用 -->
        <div class="content-box">
            <h3 class="text-xl font-semibold mb-4">
                <i class="fas fa-table text-orange-600"></i> 4. ResultSetによるデータ取得
            </h3>

            <div class="info-box">
                <h4 class="text-lg font-semibold text-blue-700 mb-2">📋 ResultSetの主要メソッド</h4>
                <table>
                    <thead>
                        <tr>
                            <th>メソッド</th>
                            <th>説明</th>
                            <th>使用例</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>next()</td>
                            <td>次の行に移動（最初は1行目の前にいる）</td>
                            <td>while (rs.next()) { ... }</td>
                        </tr>
                        <tr>
                            <td>getString(列名)</td>
                            <td>指定した列の値を文字列として取得</td>
                            <td>rs.getString("name")</td>
                        </tr>
                        <tr>
                            <td>getInt(列名)</td>
                            <td>指定した列の値を整数として取得</td>
                            <td>rs.getInt("age")</td>
                        </tr>
                        <tr>
                            <td>getDate(列名)</td>
                            <td>指定した列の値を日付として取得</td>
                            <td>rs.getDate("created_at")</td>
                        </tr>
                        <tr>
                            <td>wasNull()</td>
                            <td>最後に取得した値がNULLかどうか確認</td>
                            <td>if (rs.wasNull()) { ... }</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="warning-box">
                <h4 class="text-lg font-semibold text-red-700 mb-2">⚠️ ResultSet使用時の注意点</h4>
                <ul class="space-y-2">
                    <li><strong>カーソルの概念：</strong> 最初は1行目の前にカーソルがあり、next()で行を移動</li>
                    <li><strong>データ型の一致：</strong> 列のデータ型に適したgetXXX()メソッドを使用</li>
                    <li><strong>NULL値の処理：</strong> データベースのNULL値は適切に処理する必要がある</li>
                    <li><strong>リソース管理：</strong> 使用後は必ずclose()する</li>
                </ul>
            </div>

            <div class="code-example">
                <h4 class="font-semibold mb-2">ResultSetの実践的な使用例</h4>
                <pre><code class="language-java">
public class ResultSetExample {
    
    public static void displayAllUsers(Connection conn) {
        String sql = "SELECT id, name, age, email, created_at FROM users ORDER BY id";
        
        try (Statement stmt = conn.createStatement();
             ResultSet rs = stmt.executeQuery(sql)) {
            
            System.out.println("=== ユーザー一覧 ===");
            System.out.printf("%-5s %-15s %-5s %-25s %-12s%n", 
                "ID", "名前", "年齢", "メールアドレス", "登録日");
            System.out.println("-".repeat(70));
            
            while (rs.next()) {
                int id = rs.getInt("id");
                String name = rs.getString("name");
                int age = rs.getInt("age");
                String email = rs.getString("email");
                Date createdAt = rs.getDate("created_at");
                
                // NULL値の処理例
                if (rs.wasNull()) {
                    System.out.println("NULL値が検出されました");
                }
                
                System.out.printf("%-5d %-15s %-5d %-25s %-12s%n", 
                    id, name, age, email, 
                    createdAt != null ? createdAt.toString() : "未設定");
            }
            
        } catch (SQLException e) {
            System.err.println("データ取得エラー: " + e.getMessage());
        }
    }
    
    // 集計データの取得例
    public static void getUserStatistics(Connection conn) {
        String sql = "SELECT COUNT(*) as user_count, AVG(age) as avg_age, " +
                    "MIN(age) as min_age, MAX(age) as max_age FROM users";
        
        try (Statement stmt = conn.createStatement();
             ResultSet rs = stmt.executeQuery(sql)) {
            
            if (rs.next()) {
                System.out.println("=== ユーザー統計情報 ===");
                System.out.println("総ユーザー数: " + rs.getInt("user_count") + "人");
                System.out.println("平均年齢: " + String.format("%.1f", rs.getDouble("avg_age")) + "歳");
                System.out.println("最年少: " + rs.getInt("min_age") + "歳");
                System.out.println("最年長: " + rs.getInt("max_age") + "歳");
            }
            
        } catch (SQLException e) {
            System.err.println("統計データ取得エラー: " + e.getMessage());
        }
    }
}
                </code></pre>
            </div>
        </div>

        <!-- 5. トランザクション制御 -->
        <div class="content-box">
            <h3 class="text-xl font-semibold mb-4">
                <i class="fas fa-shield-alt text-red-600"></i> 5. トランザクション制御
            </h3>

            <div class="info-box">
                <h4 class="text-lg font-semibold text-blue-700 mb-2">🔄 トランザクションとは</h4>
                <p class="mb-2"><span class="highlight">トランザクション</span>: 複数のデータベース操作を一つの単位として扱い、全て成功するか全て失敗するかを保証する仕組みです。</p>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <h5 class="font-semibold text-green-600">ACID特性</h5>
                        <ul class="space-y-1 text-sm">
                            <li><strong>A</strong>tomicity（原子性）: 全て実行されるか全て実行されない</li>
                            <li><strong>C</strong>onsistency（一貫性）: データの整合性を保つ</li>
                            <li><strong>I</strong>solation（独立性）: 他の処理から独立して実行</li>
                            <li><strong>D</strong>urability（持続性）: 結果が永続的に保存される</li>
                        </ul>
                    </div>
                    <div>
                        <h5 class="font-semibold text-orange-600">実用例</h5>
                        <ul class="space-y-1 text-sm">
                            <li>銀行の振込処理（出金と入金をセット）</li>
                            <li>注文処理（在庫減算と注文登録）</li>
                            <li>ユーザー登録（複数テーブルへの挿入）</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="code-example">
                <h4 class="font-semibold mb-2">銀行振込処理のトランザクション例</h4>
                <pre><code class="language-java">
public class TransactionExample {
    
    public static boolean transferMoney(Connection conn, int fromAccountId, 
                                       int toAccountId, double amount) {
        
        // 自動コミットを無効化（トランザクション開始）
        try {
            conn.setAutoCommit(false);
            
            // 1. 送金元口座から出金
            String withdrawSql = "UPDATE accounts SET balance = balance - ? WHERE account_id = ? AND balance >= ?";
            try (PreparedStatement withdrawStmt = conn.prepareStatement(withdrawSql)) {
                withdrawStmt.setDouble(1, amount);
                withdrawStmt.setInt(2, fromAccountId);
                withdrawStmt.setDouble(3, amount); // 残高確認
                
                int withdrawResult = withdrawStmt.executeUpdate();
                if (withdrawResult == 0) {
                    throw new SQLException("残高不足または口座が存在しません");
                }
            }
            
            // 2. 送金先口座に入金
            String depositSql = "UPDATE accounts SET balance = balance + ? WHERE account_id = ?";
            try (PreparedStatement depositStmt = conn.prepareStatement(depositSql)) {
                depositStmt.setDouble(1, amount);
                depositStmt.setInt(2, toAccountId);
                
                int depositResult = depositStmt.executeUpdate();
                if (depositResult == 0) {
                    throw new SQLException("送金先口座が存在しません");
                }
            }
            
            // 3. 取引履歴を記録
            String historySql = "INSERT INTO transaction_history (from_account, to_account, amount, transaction_date) VALUES (?, ?, ?, NOW())";
            try (PreparedStatement historyStmt = conn.prepareStatement(historySql)) {
                historyStmt.setInt(1, fromAccountId);
                historyStmt.setInt(2, toAccountId);
                historyStmt.setDouble(3, amount);
                historyStmt.executeUpdate();
            }
            
            // 全ての処理が成功した場合、変更を確定
            conn.commit();
            System.out.println("振込処理が正常に完了しました");
            return true;
            
        } catch (SQLException e) {
            try {
                // エラーが発生した場合、全ての変更を取り消し
                conn.rollback();
                System.err.println("振込処理でエラーが発生したため、ロールバックしました: " + e.getMessage());
            } catch (SQLException rollbackEx) {
                System.err.println("ロールバック処理でエラーが発生: " + rollbackEx.getMessage());
            }
            return false;
            
        } finally {
            try {
                // 自動コミットを元に戻す
                conn.setAutoCommit(true);
            } catch (SQLException e) {
                System.err.println("自動コミット設定復元エラー: " + e.getMessage());
            }
        }
    }
}
                </code></pre>
            </div>
        </div>

        <!-- ITエンジニア豆知識 -->
        <div class="section-header">
            <h2 class="text-2xl font-bold">
                <i class="fas fa-lightbulb"></i> ITエンジニア豆知識
            </h2>
        </div>

        <div class="content-box">
            <div class="grid md:grid-cols-3 gap-6">
                <div class="info-box">
                    <h3 class="text-lg font-semibold text-blue-700 mb-2">
                        <i class="fas fa-database"></i> データベースの歴史
                    </h3>
                    <p class="text-sm">リレーショナルデータベースは1970年にIBMのエドガー・コッドが提唱。現在広く使われているSQLは1980年代に標準化されました。JDBCは1997年に登場し、Javaアプリケーションからデータベースアクセスを統一化しました。</p>
                </div>
                <div class="success-box">
                    <h3 class="text-lg font-semibold text-green-700 mb-2">
                        <i class="fas fa-shield-alt"></i> SQLインジェクション対策
                    </h3>
                    <p class="text-sm">SQLインジェクションは深刻なセキュリティ脅威です。PreparedStatementを使用することで、ユーザー入力を適切にエスケープし、悪意のあるSQL文の実行を防げます。「Little Bobby Tables」で検索してみましょう！</p>
                </div>
                <div class="warning-box">
                    <h3 class="text-lg font-semibold text-red-700 mb-2">
                        <i class="fas fa-performance"></i> パフォーマンス最適化
                    </h3>
                    <p class="text-sm">データベース接続はコストが高い処理です。実際のシステムでは「コネクションプール」を使用して接続を再利用します。また、インデックスの適切な設計により、検索性能を大幅に向上できます。</p>
                </div>
            </div>
        </div>

        <!-- 演習問題 -->
        <div class="section-header">
            <h2 class="text-2xl font-bold">
                <i class="fas fa-dumbbell"></i> 演習問題
            </h2>
        </div>

        <div class="exercise-container">
            <h3 class="text-xl font-semibold mb-4">演習1: 社員管理システムの基本機能実装</h3>
            <p><strong>問題:</strong> 以下の要件を満たす社員管理システムを作成してください。</p>
            <ul class="mb-4">
                <li>社員テーブル（employees）: id, name, department, salary, hire_date</li>
                <li>機能1: 新しい社員の登録</li>
                <li>機能2: 部署名による社員検索</li>
                <li>機能3: 給与範囲による社員検索</li>
                <li>機能4: 社員情報の更新</li>
            </ul>
            
            <button class="btn-show-answer" onclick="showExerciseAnswer(1)">回答例を表示</button>
            
            <div id="exerciseAnswer1" class="answer-section">
                <h4 class="font-semibold mb-2">回答例とポイント解説</h4>
                <div class="code-example">
                    <pre><code class="language-java">
public class EmployeeManager {
    private Connection connection;
    
    public EmployeeManager(Connection conn) {
        this.connection = conn;
    }
    
    // 機能1: 社員登録
    public boolean addEmployee(String name, String department, double salary, Date hireDate) {
        String sql = "INSERT INTO employees (name, department, salary, hire_date) VALUES (?, ?, ?, ?)";
        
        try (PreparedStatement pstmt = connection.prepareStatement(sql)) {
            pstmt.setString(1, name);
            pstmt.setString(2, department);
            pstmt.setDouble(3, salary);
            pstmt.setDate(4, hireDate);
            
            int result = pstmt.executeUpdate();
            return result > 0;
            
        } catch (SQLException e) {
            System.err.println("社員登録エラー: " + e.getMessage());
            return false;
        }
    }
    
    // 機能2: 部署名検索
    public void searchByDepartment(String department) {
        String sql = "SELECT * FROM employees WHERE department = ? ORDER BY name";
        
        try (PreparedStatement pstmt = connection.prepareStatement(sql)) {
            pstmt.setString(1, department);
            ResultSet rs = pstmt.executeQuery();
            
            System.out.println("部署: " + department + " の社員一覧");
            while (rs.next()) {
                displayEmployee(rs);
            }
            
        } catch (SQLException e) {
            System.err.println("検索エラー: " + e.getMessage());
        }
    }
    
    private void displayEmployee(ResultSet rs) throws SQLException {
        System.out.printf("ID: %d, 名前: %s, 部署: %s, 給与: %.0f円, 入社日: %s%n",
            rs.getInt("id"), rs.getString("name"), rs.getString("department"),
            rs.getDouble("salary"), rs.getDate("hire_date"));
    }
}
                    </code></pre>
                </div>
                <p class="mt-2"><strong>重要ポイント:</strong></p>
                <ul>
                    <li>PreparedStatementを使用してSQLインジェクション対策を実施</li>
                    <li>適切な例外処理でエラーハンドリング</li>
                    <li>メソッドの責任を明確に分離（単一責任原則）</li>
                </ul>
            </div>
        </div>

        <div class="exercise-container">
            <h3 class="text-xl font-semibold mb-4">演習2: 在庫管理システムのトランザクション処理</h3>
            <p><strong>問題:</strong> 商品注文処理において、在庫減算と注文履歴記録をトランザクションとして実装してください。</p>
            
            <button class="btn-show-answer" onclick="showExerciseAnswer(2)">回答例を表示</button>
            
            <div id="exerciseAnswer2" class="answer-section">
                <h4 class="font-semibold mb-2">トランザクション処理の実装例</h4>
                <div class="code-example">
                    <pre><code class="language-java">
public class OrderProcessor {
    
    public boolean processOrder(Connection conn, int productId, int quantity, int customerId) {
        try {
            conn.setAutoCommit(false);
            
            // 1. 在庫確認と減算
            String checkStockSql = "SELECT stock_quantity FROM products WHERE id = ? FOR UPDATE";
            String updateStockSql = "UPDATE products SET stock_quantity = stock_quantity - ? WHERE id = ?";
            
            try (PreparedStatement checkStmt = conn.prepareStatement(checkStockSql)) {
                checkStmt.setInt(1, productId);
                ResultSet rs = checkStmt.executeQuery();
                
                if (!rs.next()) {
                    throw new SQLException("商品が存在しません");
                }
                
                int currentStock = rs.getInt("stock_quantity");
                if (currentStock < quantity) {
                    throw new SQLException("在庫不足です（在庫: " + currentStock + "）");
                }
            }
            
            try (PreparedStatement updateStmt = conn.prepareStatement(updateStockSql)) {
                updateStmt.setInt(1, quantity);
                updateStmt.setInt(2, productId);
                updateStmt.executeUpdate();
            }
            
            // 2. 注文履歴記録
            String orderSql = "INSERT INTO orders (customer_id, product_id, quantity, order_date) VALUES (?, ?, ?, NOW())";
            try (PreparedStatement orderStmt = conn.prepareStatement(orderSql)) {
                orderStmt.setInt(1, customerId);
                orderStmt.setInt(2, productId);
                orderStmt.setInt(3, quantity);
                orderStmt.executeUpdate();
            }
            
            conn.commit();
            return true;
            
        } catch (SQLException e) {
            try {
                conn.rollback();
            } catch (SQLException rollbackEx) {
                System.err.println("ロールバックエラー: " + rollbackEx.getMessage());
            }
            System.err.println("注文処理エラー: " + e.getMessage());
            return false;
            
        } finally {
            try {
                conn.setAutoCommit(true);
            } catch (SQLException e) {
                System.err.println("自動コミット復元エラー: " + e.getMessage());
            }
        }
    }
}
                    </code></pre>
                </div>
                <p class="mt-2"><strong>学習ポイント:</strong></p>
                <ul>
                    <li>FOR UPDATEを使用した排他制御</li>
                    <li>適切なロールバック処理</li>
                    <li>リソース管理の重要性</li>
                </ul>
            </div>
        </div>

        <!-- 理解度クイズ -->
        <div class="section-header">
            <h2 class="text-2xl font-bold">
                <i class="fas fa-question-circle"></i> 理解度確認クイズ
            </h2>
        </div>

        <div class="quiz-container">
            <h3 class="text-xl font-semibold mb-4">クイズ1: JDBCの基本概念</h3>
            <p class="mb-4"><strong>問題:</strong> JDBCに関する説明として正しいものはどれですか？</p>
            <ol class="space-y-2">
                <li>A) JDBCはJavaでデータベースにアクセスするための標準API</li>
                <li>B) JDBCはデータベース管理システムの名前</li>
                <li>C) JDBCはHTTP通信専用のライブラリ</li>
                <li>D) JDBCはIDEの拡張機能</li>
            </ol>
            
            <button class="btn-show-answer" onclick="showAnswer(1)">回答を表示</button>
            
            <div id="answer1" class="answer-section">
                <p><strong>正解: A) JDBCはJavaでデータベースにアクセスするための標準API</strong></p>
                <p class="mt-2"><strong>解説:</strong> JDBC（Java Database Connectivity）は、Javaアプリケーションからデータベースにアクセスするための標準的なAPIです。異なるデータベース管理システム（MySQL、Oracle、PostgreSQLなど）に対して統一的なインターフェースを提供します。</p>
            </div>
        </div>

        <div class="quiz-container">
            <h3 class="text-xl font-semibold mb-4">クイズ2: PreparedStatementの利点</h3>
            <p class="mb-4"><strong>問題:</strong> PreparedStatementを使用する主な利点として正しくないものはどれですか？</p>
            <ol class="space-y-2">
                <li>A) SQLインジェクション攻撃を防げる</li>
                <li>B) パフォーマンスが向上する</li>
                <li>C) データベース接続が不要になる</li>
                <li>D) 型安全なパラメータ設定ができる</li>
            </ol>
            
            <button class="btn-show-answer" onclick="showAnswer(2)">回答を表示</button>
            
            <div id="answer2" class="answer-section">
                <p><strong>正解: C) データベース接続が不要になる</strong></p>
                <p class="mt-2"><strong>解説:</strong> PreparedStatementを使用しても、データベース接続（Connection）は必要です。PreparedStatementの利点は、SQLの事前コンパイル、パラメータ化による安全性、再利用による性能向上などです。</p>
            </div>
        </div>

        <div class="quiz-container">
            <h3 class="text-xl font-semibold mb-4">クイズ3: ResultSetの使用方法</h3>
            <p class="mb-4"><strong>問題:</strong> ResultSetの使用に関する記述として正しいものはどれですか？</p>
            <ol class="space-y-2">
                <li>A) 最初から1行目のデータにカーソルが位置している</li>
                <li>B) next()メソッドで次の行に移動し、戻り値がfalseになると終了</li>
                <li>C) getString()メソッドは数値データも取得できる</li>
                <li>D) B と C の両方が正しい</li>
            </ol>
            
            <button class="btn-show-answer" onclick="showAnswer(3)">回答を表示</button>
            
            <div id="answer3" class="answer-section">
                <p><strong>正解: D) B と C の両方が正しい</strong></p>
                <p class="mt-2"><strong>解説:</strong> ResultSetは最初1行目の前にカーソルが位置し、next()で移動します。next()がfalseを返すと行がないことを示します。getString()は数値や日付も文字列として取得可能です。</p>
            </div>
        </div>

        <div class="quiz-container">
            <h3 class="text-xl font-semibold mb-4">クイズ4: トランザクション制御</h3>
            <p class="mb-4"><strong>問題:</strong> トランザクション制御に関する記述として正しいものはどれですか？</p>
            <ol class="space-y-2">
                <li>A) commit()は変更を確定し、rollback()は変更を取り消す</li>
                <li>B) setAutoCommit(false)でトランザクションを開始する</li>
                <li>C) エラー発生時は必ずrollback()を実行すべき</li>
                <li>D) 上記すべて正しい</li>
            </ol>
            
            <button class="btn-show-answer" onclick="showAnswer(4)">回答を表示</button>
            
            <div id="answer4" class="answer-section">
                <p><strong>正解: D) 上記すべて正しい</strong></p>
                <p class="mt-2"><strong>解説:</strong> トランザクション制御では、setAutoCommit(false)で自動コミットを無効化し、commit()で確定、rollback()で取り消します。エラー時のrollback()は必須です。</p>
            </div>
        </div>

        <div class="quiz-container">
            <h3 class="text-xl font-semibold mb-4">クイズ5: リソース管理</h3>
            <p class="mb-4"><strong>問題:</strong> JDBCリソースの管理に関して最も適切な方法はどれですか？</p>
            <ol class="space-y-2">
                <li>A) finallyブロックで手動でclose()を呼ぶ</li>
                <li>B) try-with-resources文を使用する</li>
                <li>C) ガベージコレクションに任せる</li>
                <li>D) A と B の両方が適切</li>
            </ol>
            
            <button class="btn-show-answer" onclick="showAnswer(5)">回答を表示</button>
            
            <div id="answer5" class="answer-section">
                <p><strong>正解: D) A と B の両方が適切</strong></p>
                <p class="mt-2"><strong>解説:</strong> try-with-resources文が最も推奨されますが、finallyブロックでの手動close()も適切です。ガベージコレクションに任せるのは不適切で、メモリリークの原因となります。適切なリソース管理は必須です。</p>
            </div>
        </div>

        <!-- まとめ -->
        <div class="section-header">
            <h2 class="text-2xl font-bold">
                <i class="fas fa-chart-line"></i> まとめと次回予告
            </h2>
        </div>

        <div class="content-box">
            <h3 class="text-xl font-semibold mb-4">本日の重要ポイント</h3>
            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <h4 class="text-lg font-semibold text-blue-700 mb-2">技術面での習得内容</h4>
                    <ul class="space-y-2">
                        <li><strong>JDBC接続:</strong> DriverManagerを使用したデータベース接続の確立方法をマスター</li>
                        <li><strong>安全なSQL実行:</strong> PreparedStatementによるSQLインジェクション対策を実装</li>
                        <li><strong>データ取得:</strong> ResultSetを使用した効率的なデータ処理技術を習得</li>
                        <li><strong>トランザクション:</strong> データ整合性を保つための制御方法を理解</li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-semibold text-green-700 mb-2">実務への応用</h4>
                    <ul class="space-y-2">
                        <li><strong>セキュリティ意識:</strong> SQLインジェクション等の脅威に対する対策力を向上</li>
                        <li><strong>パフォーマンス:</strong> 効率的なデータベースアクセスパターンを学習</li>
                        <li><strong>エラーハンドリング:</strong> 例外処理による堅牢なアプリケーション設計</li>
                        <li><strong>設計パターン:</strong> DAOパターン等の実践的な設計手法を理解</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="info-box">
            <h3 class="text-xl font-semibold mb-4">次回（Day19）の学習内容</h3>
            <p class="mb-2"><strong>テーマ:</strong> ネットワークプログラミング基礎</p>
            <ul>
                <li>Socket通信による通信プログラムの作成</li>
                <li>HTTP通信とWebAPI連携</li>
                <li>クライアント・サーバー型アプリケーション開発</li>
                <li>非同期通信とマルチスレッド処理</li>
            </ul>
            <p class="mt-2 text-sm text-gray-600">本日学習したデータベース技術と組み合わせることで、より実践的なWebアプリケーション開発が可能になります。</p>
        </div>

        <!-- ナビゲーション -->
        <div class="section-header">
            <h2 class="text-2xl font-bold">
                <i class="fas fa-link"></i> 関連ページ
            </h2>
        </div>

        <div class="content-box">
            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <h4 class="font-semibold mb-2">講義ページ</h4>
                    <ul class="space-y-1">
                        <li><a href="day17_lecture.html" class="text-blue-600 hover:underline">Day17: I/Oストリームとファイル操作</a></li>
                        <li><a href="day19_lecture.html" class="text-blue-600 hover:underline">Day19: ネットワークプログラミング基礎</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold mb-2">週・月単位</h4>
                    <ul class="space-y-1">
                        <li><a href="../week/week3.html" class="text-blue-600 hover:underline">第3週一覧</a></li>
                        <li><a href="../month/month1.html" class="text-blue-600 hover:underline">第1ヶ月目一覧</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- フッター -->
        <footer class="text-center mt-12 py-6 border-t-2 border-gray-300">
            <p class="text-gray-600">© 2025 APSA Co.,Ltd. All Rights Reserved.</p>
        </footer>
    </div>
    </main>

    <script>
        function showAnswer(questionId) {
            const answer = document.getElementById('answer' + questionId);
            const button = answer.previousElementSibling;
            
            if (answer.style.display === 'none' || answer.style.display === '') {
                answer.style.display = 'block';
                button.textContent = '回答を非表示';
                button.style.backgroundColor = '#f44336';
            } else {
                answer.style.display = 'none';
                button.textContent = '回答を表示';
                button.style.backgroundColor = '#2196f3';
            }
        }

        function showExerciseAnswer(exerciseId) {
            const answer = document.getElementById('exerciseAnswer' + exerciseId);
            const button = answer.previousElementSibling;
            
            if (answer.style.display === 'none' || answer.style.display === '') {
                answer.style.display = 'block';
                button.textContent = '回答例を非表示';
                button.style.backgroundColor = '#f44336';
            } else {
                answer.style.display = 'none';
                button.textContent = '回答例を表示';
                button.style.backgroundColor = '#2196f3';
            }
        }

        // ページ読み込み時の初期化
        document.addEventListener('DOMContentLoaded', function() {
            // すべての回答セクションを非表示に
            const answers = document.querySelectorAll('.answer-section');
            answers.forEach(answer => {
                answer.style.display = 'none';
            });
        });
    </script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDqvy2USMyz27xq3k%2B7KBcs6D8RS1h7A5ucfJi8%2FnXiBcUxf5byFErh3GufkHT%2Fg66%2B6ovVREOI1dhBdPqxWdfV%2BZ2x3WKA5Af6nYH8aOyV5YXu8U2dBB%2BtdcRiKtxqrLdKU4WfjeNrZ7%2FvH2PaI4lJXit6V%2BNrPHUwJlFPvsIK2yUz1CAxgOqWPKpYgCHQVzVpNnNCCjIlP%2FPqlFR1B%2BCWVAMc0UarHGedSUJvf%2BM7y7FROk0m7S3Nw8uNlZGmZvzBE0kwXX6tufjNSfYT8qiUL9O49gmMfIjJJzTS1QFEukiR%2FDFY59iySuhcQXa9mWOFDDwqb0W3wXXcdEy9POHl59D9D8jLzIc0JmqrH%2B%2FseryZqoXvNHQCGxNByhhT%2F2UNLWNebK7QBSeJSZYmQkpYRfv6zrz8TY9ByL2yImzDDTpNV3Lz1SM0Y4eON3UOBwUL0Hp%2Bh93fDnXLMqcCs6wIvVvqwK9%2FzHXxBoZ0F8LIWePJ2tnwdUW%2BctG%2Bibw8Z5Ww%3D%3D";
        window.__genspark_locale = "ja-JP";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDqvy2USMyz27xq3k+7KBcs6D8RS1h7A5ucfJi8/nXiBcUxf5byFErh3GufkHT/g66+6ovVREOI1dhBdPqxWdfV+Z2x3WKA5Af6nYH8aOyV5YXu8U2dBB+tdcRiKtxqrLdKU4WfjeNrZ7/vH2PaI4lJXit6V+NrPHUwJlFPvsIK2yUz1CAxgOqWPKpYgCHQVzVpNnNCCjIlP/PqlFR1B+CWVAMc0UarHGedSUJvf+M7y7FROk0m7S3Nw8uNlZGmZvzBE0kwXX6tufjNSfYT8qiUL9O49gmMfIjJJzTS1QFEukiR/DFY59iySuhcQXa9mWOFDDwqb0W3wXXcdEy9POHl59D9D8jLzIc0JmqrH+/seryZqoXvNHQCGxNByhhT/2UNLWNebK7QBSeJSZYmQkpYRfv6zrz8TY9ByL2yImzDDTpNV3Lz1SM0Y4eON3UOBwUL0Hp+h93fDnXLMqcCs6wIvVvqwK9/zHXxBoZ0F8LIWePJ2tnwdUW+ctG+ibw8Z5Ww==";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    