<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ITエンジニア育成カリキュラム - Day13: ラムダ式と関数型プログラミング基礎</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 0.375rem;
            padding: 1rem;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            line-height: 1.5;
            overflow-x: auto;
        }
        .instructor-note {
            background-color: #e8f5e8;
            border-left: 4px solid #4caf50;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 0.375rem 0.375rem 0;
        }
        .understanding-point {
            background-color: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 0.375rem 0.375rem 0;
        }
        .practical-use {
            background-color: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 0.375rem 0.375rem 0;
        }
        .warning-box {
            background-color: #ffebee;
            border-left: 4px solid #f44336;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 0.375rem 0.375rem 0;
        }
        .answer-section {
            background-color: #f0f8ff;
            border: 2px solid #4169e1;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
        }
        .quiz-question {
            background-color: #fafafa;
            border: 1px solid #e0e0e0;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 1rem 0;
        }
        .show-answer-btn {
            background-color: #4caf50;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.875rem;
            transition: background-color 0.3s;
        }
        .show-answer-btn:hover {
            background-color: #45a049;
        }
        .interface-comparison {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        .interface-card {
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 0.5rem;
            padding: 1rem;
        }
    .method-ref-pattern {
        background-color: #f5f5f5;
        border: 1px solid #ccc;
        border-radius: 0.375rem;
        padding: 1rem;
        margin: 0.5rem 0;
    }
    .fixed-nav {
        backdrop-filter: blur(10px);
        background-color: rgba(255, 255, 255, 0.95);
    }
    .nav-link:hover {
        background-color: rgba(59, 130, 246, 0.1);
    }
    .breadcrumb-separator::after {
        content: ">";
        margin: 0 8px;
        color: #9CA3AF;
    }
</style>
</head>
<body class="bg-gray-50 font-sans">
    <nav class="fixed top-0 left-0 right-0 z-50 fixed-nav border-b border-gray-200">
        <div class="bg-blue-600 text-white">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-12">
                    <div class="flex items-center">
                        <i class="fas fa-graduation-cap mr-2"></i>
                        <span class="font-semibold">ITエンジニア育成カリキュラム</span>
                    </div>
                    <div class="flex items-center space-x-4">
                        <a href="./lecture12.html" class="nav-link px-3 py-1 rounded text-sm hover:bg-blue-700 transition-colors">
                            <i class="fas fa-chevron-left mr-1"></i> 前の講義
                        </a>
                        <a href="./lecture14.html" class="nav-link px-3 py-1 rounded text-sm hover:bg-blue-700 transition-colors">
                            次の講義 <i class="fas fa-chevron-right ml-1"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="bg-white px-4 py-3">
            <div class="max-w-7xl mx-auto">
                <div class="flex items-center justify-between">
                    <div class="flex items-center text-sm text-gray-600">
                        <a href="../index.html" class="hover:text-blue-600"><i class="fas fa-home mr-1"></i>ホーム</a>
                        <span class="breadcrumb-separator"></span>
                        <a href="../month/month1.html" class="hover:text-blue-600">1ヶ月目: Java基礎</a>
                        <span class="breadcrumb-separator"></span>
                        <a href="../week/week3.html" class="hover:text-blue-600">3週目: Java言語応用</a>
                        <span class="breadcrumb-separator"></span>
                        <span class="font-semibold text-blue-600">13日目: ラムダ式と関数型プログラミング基礎</span>
                    </div>
                    <div class="flex items-center space-x-3">
                        <a href="../day/day13.html" class="inline-flex items-center px-3 py-1 border border-blue-300 rounded-md text-sm text-blue-600 hover:bg-blue-50 transition-colors">
                            <i class="fas fa-clipboard-list mr-1"></i> 本日の概要
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    <main class="pt-32">
        <header class="bg-blue-600 text-white shadow-lg">
            <div class="container mx-auto px-4 py-4">
                <div class="text-center">
                    <h1 class="text-xl md:text-2xl font-bold">ITエンジニア育成カリキュラム</h1>
                    <p class="text-blue-200 text-sm md:text-base">Day13: ラムダ式と関数型プログラミング基礎</p>
                    <p class="text-blue-100 text-sm md:text-base">@FunctionalInterface とメソッド参照</p>
                </div>
            </div>
        </header>
        <div class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- 学習目標 -->
        <section class="bg-white rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                <i class="fas fa-target text-blue-600 mr-3"></i>学習目標
            </h2>
            <ul class="list-disc list-inside space-y-2 text-gray-700">
                <li>ラムダ式の構文と特徴を理解する</li>
                <li>関数型インターフェースを作成・利用できる</li>
                <li>メソッド参照のパターンを説明できる</li>
            </ul>
        </section>

        <!-- スケジュール表 -->
        <section class="bg-white rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                <i class="fas fa-clock text-green-600 mr-3"></i>本日のスケジュール
            </h2>
            <div class="overflow-x-auto">
                <table class="w-full border-collapse border border-gray-300">
                    <thead>
                        <tr class="bg-gray-100">
                            <th class="border border-gray-300 px-4 py-3 text-left font-semibold">時間</th>
                            <th class="border border-gray-300 px-4 py-3 text-left font-semibold">内容</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td class="border border-gray-300 px-4 py-2">10:00-10:15</td><td class="border border-gray-300 px-4 py-2">前日の復習</td></tr>
                        <tr class="bg-gray-50"><td class="border border-gray-300 px-4 py-2">10:15-11:00</td><td class="border border-gray-300 px-4 py-2">ラムダ式の基本構文</td></tr>
                        <tr><td class="border border-gray-300 px-4 py-2">11:00-12:00</td><td class="border border-gray-300 px-4 py-2">関数型インターフェースとメソッド参照</td></tr>
                        <tr class="bg-gray-50"><td class="border border-gray-300 px-4 py-2">12:00-13:00</td><td class="border border-gray-300 px-4 py-2">昼休憩</td></tr>
                        <tr><td class="border border-gray-300 px-4 py-2">13:00-14:15</td><td class="border border-gray-300 px-4 py-2">標準APIの関数型インターフェース活用</td></tr>
                        <tr class="bg-gray-50"><td class="border border-gray-300 px-4 py-2">14:15-15:15</td><td class="border border-gray-300 px-4 py-2">ラムダ式とスコープ・変数キャプチャ</td></tr>
                        <tr><td class="border border-gray-300 px-4 py-2">15:15-16:00</td><td class="border border-gray-300 px-4 py-2">演習：Comparatorをラムダで実装</td></tr>
                        <tr class="bg-gray-50"><td class="border border-gray-300 px-4 py-2">16:00-16:40</td><td class="border border-gray-300 px-4 py-2">理解度クイズ</td></tr>
                        <tr><td class="border border-gray-300 px-4 py-2">16:40-17:00</td><td class="border border-gray-300 px-4 py-2">まとめと次回予告</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- 講師向け詳細説明指針 -->
        <section class="bg-green-50 border-l-4 border-green-500 p-6 mb-8">
            <h2 class="text-xl font-bold text-green-800 mb-4">📚 講師向け詳細説明指針</h2>
            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <h3 class="font-semibold text-green-700 mb-2">重要な説明ポイント</h3>
                    <ul class="text-sm text-green-700 space-y-1">
                        <li>• ラムダ式は「匿名関数の短縮記法」であることを強調</li>
                        <li>• 関数型インターフェースの「なぜ1つの抽象メソッドか」を説明</li>
                        <li>• メソッド参照は「コードの可読性向上」が目的</li>
                        <li>• effective final制約の「安全性」の意味を解説</li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-semibold text-green-700 mb-2">よくあるつまずきポイント</h3>
                    <ul class="text-sm text-green-700 space-y-1">
                        <li>• ラムダ式の構文省略ルールの混乱</li>
                        <li>• Function/Consumer/Supplier/Predicateの使い分け</li>
                        <li>• メソッド参照4パターンの区別</li>
                        <li>• 外部変数参照時のeffective final制約</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- メイン講義 -->
        <section class="space-y-8">
            <!-- ラムダ式の構文 -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-code text-purple-600 mr-3"></i>ラムダ式の構文
                </h3>
                
                <div class="understanding-point">
                    <h4 class="font-semibold text-blue-800 mb-2">💡 理解促進ポイント</h4>
                    <p class="text-blue-700">ラムダ式は「名前のない関数」を作る記法です。まるで「使い捨ての道具」のように、その場限りで使える小さな処理を簡潔に書けます。</p>
                </div>

                <h4 class="font-semibold text-gray-700 mb-2">基本構文</h4>
                <div class="code-block mb-4">
<pre>// 基本形：(引数) -> {処理}
(String name) -> { System.out.println("Hello, " + name); }

// 引数が1つの場合：括弧省略可能
name -> System.out.println("Hello, " + name)

// 処理が1行の場合：波括弧とreturn省略可能
(x, y) -> x + y

// 引数なしの場合：空の括弧
() -> System.out.println("No arguments")</pre>
                </div>

                <div class="instructor-note">
                    <h4 class="font-semibold text-green-800 mb-2">🎯 講師説明のポイント</h4>
                    <p class="text-green-700">省略ルールは段階的に教えましょう。最初は完全形で書かせ、慣れてきたら省略形を紹介します。「なぜ省略できるか」をコンパイラの型推論と関連付けて説明すると理解が深まります。</p>
                </div>

                <h4 class="font-semibold text-gray-700 mb-2">従来の書き方との比較</h4>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <p class="font-medium text-gray-600 mb-2">従来の匿名クラス</p>
                        <div class="code-block">
<pre>Comparator&lt;String&gt; comp = new Comparator&lt;String&gt;() {
    @Override
    public int compare(String a, String b) {
        return a.length() - b.length();
    }
};</pre>
                        </div>
                    </div>
                    <div>
                        <p class="font-medium text-gray-600 mb-2">ラムダ式</p>
                        <div class="code-block">
<pre>Comparator&lt;String&gt; comp = 
    (a, b) -> a.length() - b.length();</pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 関数型インターフェース -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-puzzle-piece text-orange-600 mr-3"></i>関数型インターフェース
                </h3>

                <div class="understanding-point">
                    <h4 class="font-semibold text-blue-800 mb-2">💡 理解促進ポイント</h4>
                    <p class="text-blue-700">関数型インターフェースは「1つの仕事だけを定義したインターフェース」です。まるで「専用工具」のように、特定の作業に特化した設計になっています。</p>
                </div>

                <h4 class="font-semibold text-gray-700 mb-4">SAM（Single Abstract Method）とは</h4>
                <div class="bg-yellow-50 border border-yellow-200 rounded p-4 mb-4">
                    <p class="text-yellow-800"><strong>SAM</strong>：抽象メソッドが1つだけのインターフェース</p>
                    <p class="text-yellow-700 mt-2">デフォルトメソッドや静的メソッドは複数あっても構いません。重要なのは「実装が必要なメソッドが1つ」ということです。</p>
                </div>

                <h4 class="font-semibold text-gray-700 mb-4">標準的な関数型インターフェース（詳細解説版）</h4>
                <div class="interface-comparison">
                    <div class="interface-card">
                        <h5 class="font-bold text-purple-700 mb-2">Function&lt;T, R&gt;</h5>
                        <p class="text-sm text-gray-600 mb-2"><strong>役割：</strong>変換処理（入力→出力）</p>
                        <div class="code-block mb-2">
<pre>// メソッド：R apply(T t)
Function&lt;String, Integer&gt; lengthFunc = 
    s -> s.length();</pre>
                        </div>
                        <div class="bg-blue-50 p-2 rounded text-sm">
                            <strong>実用例：</strong>文字列を数値に変換、オブジェクトからプロパティを抽出
                        </div>
                    </div>

                    <div class="interface-card">
                        <h5 class="font-bold text-green-700 mb-2">Consumer&lt;T&gt;</h5>
                        <p class="text-sm text-gray-600 mb-2"><strong>役割：</strong>消費処理（入力のみ、出力なし）</p>
                        <div class="code-block mb-2">
<pre>// メソッド：void accept(T t)
Consumer&lt;String&gt; printer = 
    s -> System.out.println(s);</pre>
                        </div>
                        <div class="bg-blue-50 p-2 rounded text-sm">
                            <strong>実用例：</strong>ログ出力、ファイル書き込み、データベース保存
                        </div>
                    </div>

                    <div class="interface-card">
                        <h5 class="font-bold text-red-700 mb-2">Supplier&lt;T&gt;</h5>
                        <p class="text-sm text-gray-600 mb-2"><strong>役割：</strong>供給処理（入力なし、出力のみ）</p>
                        <div class="code-block mb-2">
<pre>// メソッド：T get()
Supplier&lt;String&gt; dateSupplier = 
    () -> LocalDate.now().toString();</pre>
                        </div>
                        <div class="bg-blue-50 p-2 rounded text-sm">
                            <strong>実用例：</strong>ランダム値生成、現在時刻取得、設定値読み込み
                        </div>
                    </div>

                    <div class="interface-card">
                        <h5 class="font-bold text-indigo-700 mb-2">Predicate&lt;T&gt;</h5>
                        <p class="text-sm text-gray-600 mb-2"><strong>役割：</strong>判定処理（入力→真偽値）</p>
                        <div class="code-block mb-2">
<pre>// メソッド：boolean test(T t)
Predicate&lt;Integer&gt; isEven = 
    n -> n % 2 == 0;</pre>
                        </div>
                        <div class="bg-blue-50 p-2 rounded text-sm">
                            <strong>実用例：</strong>条件フィルタリング、バリデーション、条件分岐
                        </div>
                    </div>
                </div>

                <div class="instructor-note">
                    <h4 class="font-semibold text-green-800 mb-2">🎯 講師説明のポイント</h4>
                    <p class="text-green-700">各インターフェースの「メソッドシグネチャ」を意識させましょう。Function&lt;T,R&gt;なら「T型を受け取ってR型を返す」、Consumer&lt;T&gt;なら「T型を受け取って何も返さない」など、型パラメータと役割の関係を明確にします。</p>
                </div>

                <h4 class="font-semibold text-gray-700 mb-2">使い分けの判断フロー</h4>
                <div class="bg-gray-50 border border-gray-200 rounded p-4">
                    <div class="text-center">
                        <div class="inline-block bg-blue-100 rounded-full px-4 py-2 mb-2">
                            <strong>何をしたいか？</strong>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-2 text-center text-sm">
                        <div class="bg-purple-100 p-2 rounded">
                            <strong>変換</strong><br>
                            Function
                        </div>
                        <div class="bg-green-100 p-2 rounded">
                            <strong>処理実行</strong><br>
                            Consumer
                        </div>
                        <div class="bg-red-100 p-2 rounded">
                            <strong>値生成</strong><br>
                            Supplier
                        </div>
                        <div class="bg-indigo-100 p-2 rounded">
                            <strong>判定</strong><br>
                            Predicate
                        </div>
                    </div>
                </div>
            </div>

            <!-- メソッド参照 -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-link text-teal-600 mr-3"></i>メソッド参照
                </h3>

                <div class="understanding-point">
                    <h4 class="font-semibold text-blue-800 mb-2">💡 理解促進ポイント</h4>
                    <p class="text-blue-700">メソッド参照は「電話の短縮ダイヤル」のようなものです。既存のメソッドをラムダ式の代わりに簡潔に指定できます。</p>
                </div>

                <h4 class="font-semibold text-gray-700 mb-4">4つのパターン（詳細解説）</h4>

                <div class="space-y-4">
                    <div class="method-ref-pattern">
                        <h5 class="font-bold text-blue-700 mb-2">1. 静的メソッド参照</h5>
                        <p class="text-sm text-gray-600 mb-2">クラス名::メソッド名</p>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <p class="font-medium text-gray-600 mb-1">ラムダ式</p>
                                <div class="code-block">
<pre>Function&lt;String, Integer&gt; parser = 
    s -> Integer.parseInt(s);</pre>
                                </div>
                            </div>
                            <div>
                                <p class="font-medium text-gray-600 mb-1">メソッド参照</p>
                                <div class="code-block">
<pre>Function&lt;String, Integer&gt; parser = 
    Integer::parseInt;</pre>
                                </div>
                            </div>
                        </div>
                        <div class="bg-blue-50 p-2 rounded text-sm mt-2">
                            <strong>使用場面：</strong>Math.max、String.valueOf、Collections.sortなどの静的ユーティリティメソッド
                        </div>
                    </div>

                    <div class="method-ref-pattern">
                        <h5 class="font-bold text-green-700 mb-2">2. 特定オブジェクトのインスタンスメソッド参照</h5>
                        <p class="text-sm text-gray-600 mb-2">オブジェクト::メソッド名</p>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <p class="font-medium text-gray-600 mb-1">ラムダ式</p>
                                <div class="code-block">
<pre>String prefix = "LOG: ";
Function&lt;String, String&gt; logger = 
    msg -> prefix.concat(msg);</pre>
                                </div>
                            </div>
                            <div>
                                <p class="font-medium text-gray-600 mb-1">メソッド参照</p>
                                <div class="code-block">
<pre>String prefix = "LOG: ";
Function&lt;String, String&gt; logger = 
    prefix::concat;</pre>
                                </div>
                            </div>
                        </div>
                        <div class="bg-green-50 p-2 rounded text-sm mt-2">
                            <strong>使用場面：</strong>特定のオブジェクトのメソッドを繰り返し呼び出す場合
                        </div>
                    </div>

                    <div class="method-ref-pattern">
                        <h5 class="font-bold text-purple-700 mb-2">3. 任意オブジェクトのインスタンスメソッド参照</h5>
                        <p class="text-sm text-gray-600 mb-2">クラス名::メソッド名（第1引数がレシーバーになる）</p>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <p class="font-medium text-gray-600 mb-1">ラムダ式</p>
                                <div class="code-block">
<pre>Comparator&lt;String&gt; comp = 
    (s1, s2) -> s1.compareToIgnoreCase(s2);</pre>
                                </div>
                            </div>
                            <div>
                                <p class="font-medium text-gray-600 mb-1">メソッド参照</p>
                                <div class="code-block">
<pre>Comparator&lt;String&gt; comp = 
    String::compareToIgnoreCase;</pre>
                                </div>
                            </div>
                        </div>
                        <div class="bg-purple-50 p-2 rounded text-sm mt-2">
                            <strong>重要：</strong>第1引数がメソッドを呼ぶオブジェクト（レシーバー）になります。上記例では s1.compareToIgnoreCase(s2) となります。
                        </div>
                    </div>

                    <div class="method-ref-pattern">
                        <h5 class="font-bold text-red-700 mb-2">4. コンストラクタ参照</h5>
                        <p class="text-sm text-gray-600 mb-2">クラス名::new</p>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <p class="font-medium text-gray-600 mb-1">ラムダ式</p>
                                <div class="code-block">
<pre>Supplier&lt;ArrayList&lt;String&gt;&gt; listSupplier = 
    () -> new ArrayList&lt;&gt;();</pre>
                                </div>
                            </div>
                            <div>
                                <p class="font-medium text-gray-600 mb-1">メソッド参照</p>
                                <div class="code-block">
<pre>Supplier&lt;ArrayList&lt;String&gt;&gt; listSupplier = 
    ArrayList::new;</pre>
                                </div>
                            </div>
                        </div>
                        <div class="bg-red-50 p-2 rounded text-sm mt-2">
                            <strong>使用場面：</strong>ファクトリメソッドパターン、Stream.collect()でのコレクション生成
                        </div>
                    </div>
                </div>

                <div class="instructor-note">
                    <h4 class="font-semibold text-green-800 mb-2">🎯 講師説明のポイント</h4>
                    <p class="text-green-700">3番目の「任意オブジェクトのインスタンスメソッド参照」が最も混乱しやすいポイントです。「第1引数がレシーバーになる」ことを図解や具体例で繰り返し説明しましょう。</p>
                </div>
            </div>

            <!-- ラムダ式とスコープ -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-eye text-pink-600 mr-3"></i>ラムダ式とスコープ・変数キャプチャ
                </h3>

                <div class="understanding-point">
                    <h4 class="font-semibold text-blue-800 mb-2">💡 理解促進ポイント</h4>
                    <p class="text-blue-700">ラムダ式は「写真」のようなものです。作成された瞬間の外部変数の値を記録し、その後変更できません。これは安全性を保つためのJavaの仕様です。</p>
                </div>

                <h4 class="font-semibold text-gray-700 mb-4">effective final制約（詳細解説）</h4>

                <div class="warning-box">
                    <h5 class="font-bold text-red-800 mb-2">⚠️ effective finalとは</h5>
                    <p class="text-red-700">ラムダ式内で参照する外部変数は、明示的にfinalでなくても「実質的に変更されない」必要があります。</p>
                </div>

                <h5 class="font-semibold text-gray-700 mb-2">正しい例</h5>
                <div class="code-block mb-4">
<pre>public void correctExample() {
    String prefix = "Hello, ";  // effective final
    
    Function&lt;String, String&gt; greeter = name -> prefix + name;
    
    // prefix は変更されていないので OK
    System.out.println(greeter.apply("Alice"));
}</pre>
                </div>

                <h5 class="font-semibold text-gray-700 mb-2">エラーになる例</h5>
                <div class="code-block mb-4">
<pre>public void errorExample() {
    String prefix = "Hello, ";
    
    Function&lt;String, String&gt; greeter = name -> prefix + name;  // コンパイルエラー！
    
    prefix = "Hi, ";  // ここで変更しているため
}</pre>
                </div>

                <div class="bg-yellow-50 border border-yellow-200 rounded p-4 mb-4">
                    <h5 class="font-bold text-yellow-800 mb-2">🤔 なぜこの制約があるのか？</h5>
                    <div class="text-yellow-700 space-y-2">
                        <p><strong>1. スレッドセーフティ：</strong>ラムダ式が別スレッドで実行される可能性があるため</p>
                        <p><strong>2. 予期しない動作の防止：</strong>ラムダ式作成後に外部変数が変更されると、実行時に混乱を招く</p>
                        <p><strong>3. 関数型プログラミングの原則：</strong>「副作用のない純粋な関数」を推奨</p>
                    </div>
                </div>

                <h5 class="font-semibold text-gray-700 mb-2">回避策</h5>
                <div class="code-block mb-4">
<pre>public void workaroundExample() {
    final AtomicReference&lt;String&gt; prefix = new AtomicReference&lt;&gt;("Hello, ");
    
    Function&lt;String, String&gt; greeter = name -> prefix.get() + name;
    
    // AtomicReferenceのメソッドで変更可能
    prefix.set("Hi, ");
    
    System.out.println(greeter.apply("Alice"));  // "Hi, Alice"
}</pre>
                </div>

                <div class="instructor-note">
                    <h4 class="font-semibold text-green-800 mb-2">🎯 講師説明のポイント</h4>
                    <p class="text-green-700">effective final制約は初心者には理解が困難です。「なぜこの制約があるのか」を具体的なトラブル例（マルチスレッド環境での予期しない動作など）で説明すると納得してもらいやすくなります。</p>
                </div>

                <h4 class="font-semibold text-gray-700 mb-4">thisキーワードの扱い</h4>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <p class="font-medium text-gray-600 mb-1">匿名クラス</p>
                        <div class="code-block">
<pre>public class Example {
    private String name = "Example";
    
    public void method() {
        Runnable r = new Runnable() {
            @Override
            public void run() {
                // この「this」は匿名クラスのインスタンス
                System.out.println(this.getClass());
            }
        };
    }
}</pre>
                        </div>
                    </div>
                    <div>
                        <p class="font-medium text-gray-600 mb-1">ラムダ式</p>
                        <div class="code-block">
<pre>public class Example {
    private String name = "Example";
    
    public void method() {
        Runnable r = () -> {
            // この「this」は外側のExampleクラスのインスタンス
            System.out.println(this.name);  // "Example"
        };
    }
}</pre>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 演習問題 -->
        <section class="bg-white rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                <i class="fas fa-pencil-alt text-yellow-600 mr-3"></i>演習問題
            </h2>
            
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                <h3 class="font-bold text-blue-800 mb-2">💡 演習：Comparatorをラムダで実装</h3>
                <p class="text-blue-700 mb-4">
                    以下のPersonクラスがあります。年齢でソートするComparatorを、従来の匿名クラス、ラムダ式、メソッド参照の3つの方法で実装してください。
                </p>
                
                <div class="code-block mb-4">
<pre>public class Person {
    private String name;
    private int age;
    
    public Person(String name, int age) {
        this.name = name;
        this.age = age;
    }
    
    public String getName() { return name; }
    public int getAge() { return age; }
    
    @Override
    public String toString() {
        return name + "(" + age + "歳)";
    }
}</pre>
                </div>

                <p class="text-blue-700 mb-2">
                    Listをソートして結果を出力するコードも作成してください。
                </p>
            </div>

            <button sec:authorize="hasAnyRole('ADMIN','INSTRUCTOR')" onclick="showExerciseAnswer(1)" class="show-answer-btn mb-4">
                <i class="fas fa-eye mr-2"></i>解答例を表示
            </button>

            <div sec:authorize="hasAnyRole('ADMIN','INSTRUCTOR')" id="exerciseAnswer1" class="answer-section" style="display:none;">
                <h4 class="font-bold text-blue-800 mb-4">📋 解答例</h4>
                
                <h5 class="font-semibold text-gray-700 mb-2">1. 従来の匿名クラス</h5>
                <div class="code-block mb-4">
<pre>import java.util.*;

public class ComparatorExample {
    public static void main(String[] args) {
        List&lt;Person&gt; people = Arrays.asList(
            new Person("Alice", 25),
            new Person("Bob", 30),
            new Person("Charlie", 20)
        );
        
        // 匿名クラス
        Comparator&lt;Person&gt; ageComparator = new Comparator&lt;Person&gt;() {
            @Override
            public int compare(Person p1, Person p2) {
                return Integer.compare(p1.getAge(), p2.getAge());
            }
        };
        
        Collections.sort(people, ageComparator);
        System.out.println("匿名クラス: " + people);
    }
}</pre>
                </div>

                <h5 class="font-semibold text-gray-700 mb-2">2. ラムダ式</h5>
                <div class="code-block mb-4">
<pre>// ラムダ式（完全形）
Comparator&lt;Person&gt; ageComparator = (Person p1, Person p2) -> {
    return Integer.compare(p1.getAge(), p2.getAge());
};

// ラムダ式（省略形）
Comparator&lt;Person&gt; ageComparator = (p1, p2) -> Integer.compare(p1.getAge(), p2.getAge());

// さらに省略
people.sort((p1, p2) -> Integer.compare(p1.getAge(), p2.getAge()));
</pre>
                </div>

                <h5 class="font-semibold text-gray-700 mb-2">3. メソッド参照</h5>
                <div class="code-block mb-4">
<pre>// メソッド参照を使用
people.sort(Comparator.comparingInt(Person::getAge));

// 逆順の場合
people.sort(Comparator.comparingInt(Person::getAge).reversed());
</pre>
                </div>

                <div class="bg-green-50 border border-green-200 rounded p-4">
                    <h5 class="font-bold text-green-800 mb-2">🎯 解説ポイント</h5>
                    <ul class="text-green-700 space-y-1">
                        <li>• 匿名クラスは冗長だが、処理の流れが明確</li>
                        <li>• ラムダ式は簡潔で読みやすい</li>
                        <li>• メソッド参照は最も簡潔で、意図が明確</li>
                        <li>• Comparator.comparingInt()は型安全で推奨される方法</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- 理解度確認クイズ -->
        <section class="bg-white rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                <i class="fas fa-question-circle text-red-600 mr-3"></i>理解度確認クイズ
            </h2>

            <div class="space-y-6">
                <div class="quiz-question">
                    <p class="font-bold text-gray-800 mb-3">1. ラムダ式の特徴として正しいものは？</p>
                    <ul class="space-y-2 mb-4">
                        <li>A: 常に匿名クラスより高速</li>
                        <li>B: メソッドを引数として扱える</li>
                        <li>C: 実行時に型が決定される</li>
                        <li>D: Java以外では使用不可</li>
                    </ul>
                    <button sec:authorize="hasAnyRole('ADMIN','INSTRUCTOR')" onclick="showAnswer(1)" class="show-answer-btn">回答を表示</button>
                    <div sec:authorize="hasAnyRole('ADMIN','INSTRUCTOR')" id="answer1" class="answer-section" style="display:none;">
                        <p><strong>正解: B</strong></p>
                        <p><strong>解説:</strong> ラムダ式は関数を値として扱える機能です。これにより、メソッドを他のメソッドの引数として渡すことができ、関数型プログラミングが可能になります。</p>
                    </div>
                </div>

                <div class="quiz-question">
                    <p class="font-bold text-gray-800 mb-3">2. 関数型インターフェースとは何か？</p>
                    <ul class="space-y-2 mb-4">
                        <li>A: 抽象メソッドを2つ以上持つインターフェース</li>
                        <li>B: 1つの抽象メソッドのみを持つインターフェース</li>
                        <li>C: ラムダ式を含むクラス</li>
                        <li>D: すべてのメソッドがデフォルト実装を持つインターフェース</li>
                    </ul>
                    <button sec:authorize="hasAnyRole('ADMIN','INSTRUCTOR')" onclick="showAnswer(2)" class="show-answer-btn">回答を表示</button>
                    <div sec:authorize="hasAnyRole('ADMIN','INSTRUCTOR')" id="answer2" class="answer-section" style="display:none;">
                        <p><strong>正解: B</strong></p>
                        <p><strong>解説:</strong> 関数型インターフェースはSAM（Single Abstract Method）インターフェースとも呼ばれ、実装が必要な抽象メソッドが1つだけのインターフェースです。デフォルトメソッドや静的メソッドは複数あっても構いません。</p>
                    </div>
                </div>

                <div class="quiz-question">
                    <p class="font-bold text-gray-800 mb-3">3. `ClassName::new` の意味は？</p>
                    <ul class="space-y-2 mb-4">
                        <li>A: 静的メソッド参照</li>
                        <li>B: コンストラクタ参照</li>
                        <li>C: インスタンスメソッド参照</li>
                        <li>D: デフォルトメソッド参照</li>
                    </ul>
                    <button sec:authorize="hasAnyRole('ADMIN','INSTRUCTOR')" onclick="showAnswer(3)" class="show-answer-btn">回答を表示</button>
                    <div sec:authorize="hasAnyRole('ADMIN','INSTRUCTOR')" id="answer3" class="answer-section" style="display:none;">
                        <p><strong>正解: B</strong></p>
                        <p><strong>解説:</strong> `ClassName::new` はコンストラクタ参照の記法です。新しいインスタンスを作成する処理をラムダ式の代わりに簡潔に記述できます。</p>
                    </div>
                </div>

                <div class="quiz-question">
                    <p class="font-bold text-gray-800 mb-3">4. ラムダ式で外部変数を参照する際の制約は？</p>
                    <ul class="space-y-2 mb-4">
                        <li>A: 参照できない</li>
                        <li>B: final もしくは実質的finalでなければならない</li>
                        <li>C: 常にコピーされる</li>
                        <li>D: スレッドセーフでなければならない</li>
                    </ul>
                    <button sec:authorize="hasAnyRole('ADMIN','INSTRUCTOR')" onclick="showAnswer(4)" class="show-answer-btn">回答を表示</button>
                    <div sec:authorize="hasAnyRole('ADMIN','INSTRUCTOR')" id="answer4" class="answer-section" style="display:none;">
                        <p><strong>正解: B</strong></p>
                        <p><strong>解説:</strong> ラムダ式内で参照する外部変数はeffective final制約により、変更不可である必要があります。これはスレッドセーフティと予期しない動作の防止のためです。</p>
                    </div>
                </div>

                <div class="quiz-question">
                    <p class="font-bold text-gray-800 mb-3">5. 以下のうち、Consumer&lt;String&gt;として適切なラムダ式は？</p>
                    <ul class="space-y-2 mb-4">
                        <li>A: `s -> s.length()`</li>
                        <li>B: `s -> System.out.println(s)`</li>
                        <li>C: `() -> "Hello"`</li>
                        <li>D: `s -> s.equals("test")`</li>
                    </ul>
                    <button sec:authorize="hasAnyRole('ADMIN','INSTRUCTOR')" onclick="showAnswer(5)" class="show-answer-btn">回答を表示</button>
                    <div sec:authorize="hasAnyRole('ADMIN','INSTRUCTOR')" id="answer5" class="answer-section" style="display:none;">
                        <p><strong>正解: B</strong></p>
                        <p><strong>解説:</strong> Consumer&lt;T&gt;は「T型を受け取って何も返さない」インターフェースです。`void accept(T t)`メソッドを持つため、戻り値のないラムダ式が適切です。Aは戻り値があり、Cは引数なし、Dは戻り値があるため不適切です。</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- まとめと次回予告 -->
        <section class="bg-white rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                <i class="fas fa-clipboard-check text-purple-600 mr-3"></i>本日のまとめ
            </h2>
            
            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <h3 class="font-bold text-purple-700 mb-3">🎯 重要ポイント</h3>
                    <ul class="space-y-2 text-gray-700">
                        <li>• <strong>ラムダ式</strong>：匿名関数を簡潔に記述する構文</li>
                        <li>• <strong>関数型インターフェース</strong>：1つの抽象メソッドを持つインターフェース</li>
                        <li>• <strong>メソッド参照</strong>：既存メソッドを簡潔に指定する記法</li>
                        <li>• <strong>effective final制約</strong>：外部変数の変更不可制約</li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-bold text-purple-700 mb-3">🔧 実践での活用</h3>
                    <ul class="space-y-2 text-gray-700">
                        <li>• Stream APIとの組み合わせ</li>
                        <li>• イベント処理の簡潔化</li>
                        <li>• コレクション操作の効率化</li>
                        <li>• 関数型プログラミングスタイルの導入</li>
                    </ul>
                </div>
            </div>

            <div class="mt-6 p-4 bg-blue-50 border border-blue-200 rounded">
                <h3 class="font-bold text-blue-800 mb-2">📚 次回予告：Day14「Stream APIと関数型プログラミング実践」</h3>
                <p class="text-blue-700">
                    今日学習したラムダ式と関数型インターフェースを活用して、Stream APIによるデータ処理を学習します。
                    filter、map、collectなどの操作を組み合わせた実践的なプログラミング技法を習得しましょう。
                </p>
            </div>
        </section>

        <!-- ナビゲーションリンク -->
        <section class="bg-gray-100 rounded-lg p-6">
            <div class="flex flex-wrap justify-center gap-4 text-sm">
                <a href="lecture12.html" class="flex items-center px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors">
                    <i class="fas fa-chevron-left mr-2"></i>前日: Day12
                </a>
                <a href="lecture14.html" class="flex items-center px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors">
                    次日: Day14<i class="fas fa-chevron-right ml-2"></i>
                </a>
                <a href="../week/week3.html" class="flex items-center px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors">
                    <i class="fas fa-calendar-week mr-2"></i>第3週一覧
                </a>
                <a href="../month/month1.html" class="flex items-center px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors">
                    <i class="fas fa-calendar-alt mr-2"></i>第1ヶ月目一覧
                </a>
            </div>
        </section>
    </div>
    </main>

    <!-- フッター -->
    <footer class="bg-gray-800 text-white py-6 mt-12">
        <div class="container mx-auto px-4 text-center">
            <p>&copy; 2025 APSA Co.,Ltd. All Rights Reserved.</p>
            <p class="text-gray-400 text-sm mt-2">開発環境: Pleiades (Eclipse) + Amazon Corretto JDK 17</p>
        </div>
    </footer>

    <script>
        function showAnswer(questionNumber) {
            const answer = document.getElementById('answer' + questionNumber);
            const button = answer.previousElementSibling;
            
            if (answer.style.display === 'none') {
                answer.style.display = 'block';
                button.innerHTML = '<i class="fas fa-eye-slash mr-2"></i>回答を非表示';
                button.classList.remove('show-answer-btn');
                button.classList.add('bg-gray-500', 'hover:bg-gray-600');
            } else {
                answer.style.display = 'none';
                button.innerHTML = '<i class="fas fa-eye mr-2"></i>回答を表示';
                button.classList.add('show-answer-btn');
                button.classList.remove('bg-gray-500', 'hover:bg-gray-600');
            }
        }

        function showExerciseAnswer(exerciseNumber) {
            const answer = document.getElementById('exerciseAnswer' + exerciseNumber);
            const button = answer.previousElementSibling;
            
            if (answer.style.display === 'none') {
                answer.style.display = 'block';
                button.innerHTML = '<i class="fas fa-eye-slash mr-2"></i>解答例を非表示';
                button.classList.remove('show-answer-btn');
                button.classList.add('bg-gray-500', 'hover:bg-gray-600');
            } else {
                answer.style.display = 'none';
                button.innerHTML = '<i class="fas fa-eye mr-2"></i>解答例を表示';
                button.classList.add('show-answer-btn');
                button.classList.remove('bg-gray-500', 'hover:bg-gray-600');
            }
        }
    </script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDsZhQN0Ey3iH%2BYivaJOXVRmXWYqhB0%2FXnCSKuALYg%2BHFr0VPFNyQL0vLma1y7dQfcBbPk3H0Lxg6y3M3P2rkGC%2F%2BFEeIXJasLmuNqf%2F9us1JH99Ah0DfwBvfNiQ2Cv77CjpvAXMNa36oZQBLAqC4DeWmCALwUks%2Bq8zuM56DAs35YozNEqNFFVw9HRnQ5Et9%2FK1IJUGRvV8n3GT8uerTycI%2Ff0fkSWH9Ef1P%2FzdoCzPNDBFZ7s1DJonfq0UchZ6DG8LCpqS9zVpu9RDYFmJc2PkkjWsuv8Tftmo8Ui1cQhwYyry%2FQ%2BF9AL2P6glT7%2BFXXbHQ4wo909wQ5QDMtU8rF%2ByaN1n0RCkjGvmz1y52U%2FrKflzHHKZ2CVKlMqk%2Fgi6TkFPj2DAGyUS485WCn%2B%2FiHrM6ffBZGZnSwJ0OqD5Zqti%2BTRVekSKOiyhwVbeLQVXpNZXWCaW4haUMsR%2FmILHHUdI2QYvyMM5P5tws%2Fk2PrPgy9AkVEyeY6s7ejDc1A27g5%2B4sY4uFWZTA0Dm%2FuR%2B8e68uo9lZ8NT2beeHe5d25sJk";
        window.__genspark_locale = "ja-JP";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDsZhQN0Ey3iH+YivaJOXVRmXWYqhB0/XnCSKuALYg+HFr0VPFNyQL0vLma1y7dQfcBbPk3H0Lxg6y3M3P2rkGC/+FEeIXJasLmuNqf/9us1JH99Ah0DfwBvfNiQ2Cv77CjpvAXMNa36oZQBLAqC4DeWmCALwUks+q8zuM56DAs35YozNEqNFFVw9HRnQ5Et9/K1IJUGRvV8n3GT8uerTycI/f0fkSWH9Ef1P/zdoCzPNDBFZ7s1DJonfq0UchZ6DG8LCpqS9zVpu9RDYFmJc2PkkjWsuv8Tftmo8Ui1cQhwYyry/Q+F9AL2P6glT7+FXXbHQ4wo909wQ5QDMtU8rF+yaN1n0RCkjGvmz1y52U/rKflzHHKZ2CVKlMqk/gi6TkFPj2DAGyUS485WCn+/iHrM6ffBZGZnSwJ0OqD5Zqti+TRVekSKOiyhwVbeLQVXpNZXWCaW4haUMsR/mILHHUdI2QYvyMM5P5tws/k2PrPgy9AkVEyeY6s7ejDc1A27g5+4sY4uFWZTA0Dm/uR+8e68uo9lZ8NT2beeHe5d25sJk";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    