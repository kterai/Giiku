<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini_GAS_JavaSilver模擬試験50問完全版</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f9fafb;
        }
        .code-block {
            background-color: #f1f5f9;
            border-left: 4px solid #3b82f6;
            padding: 1rem;
            margin: 1rem 0;
            font-family: 'Consolas', 'Courier New', monospace;
            white-space: pre-wrap;
            overflow-x: auto;
            font-size: 0.9rem;
            line-height: 1.5;
            border-radius: 0.25rem;
        }
        .question-block {
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background-color: white;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        }
        .question-block h4 {
            color: #1e40af;
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 0.5rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        .correct-answer {
            font-weight: bold;
            color: #15803d;
        }
        .advanced-question {
            border-left: 4px solid #dc2626;
        }
        .intermediate-question {
            border-left: 4px solid #f59e0b;
        }
        .basic-question {
            border-left: 4px solid #10b981;
        }
        h1, h2, h3 {
            color: #1e40af;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #e5e7eb;
            padding: 0.75rem;
            text-align: left;
        }
        th {
            background-color: #f1f5f9;
            font-weight: 600;
        }
    </style>
</head>
<body class="p-8">
    <div class="max-w-6xl mx-auto bg-white p-8 shadow-md rounded-lg">
        <h1 class="text-3xl font-bold mb-6">Gemini用 Java Silver模擬試験用Google Apps Script作成プロンプト</h1>
        
        <div class="bg-blue-50 p-4 rounded-lg mb-8 border border-blue-200">
            <h2 class="text-xl font-semibold mb-2">作成依頼内容</h2>
            <p class="mb-4">以下の仕様に基づいて、Java Silver模擬試験のGoogle FormとGoogle Spreadsheetを自動生成するGoogle Apps Script（GAS）を作成してください。このスクリプトは実行すると、50問のJava Silver試験問題を含むGoogle Formと、回答を集計・分析するためのスプレッドシートを自動的に作成します。</p>
        </div>

        <h2 class="text-2xl font-bold mt-8 mb-4">1. スクリプトの基本要件</h2>
        
        <h3 class="text-xl font-semibold mt-6 mb-3">1.1 主要機能</h3>
        <ul class="list-disc ml-6 mb-6">
            <li>Java Silver模擬試験用のGoogle Formを自動生成</li>
            <li>回答結果を保存・分析するためのスプレッドシートを自動作成</li>
            <li>フォームとスプレッドシートを連携させる</li>
            <li>テスト結果の自動採点機能</li>
            <li>カテゴリ別および問題別の分析機能</li>
            <li>受験者の個人成績レポート生成機能</li>
        </ul>

        <h3 class="text-xl font-semibold mt-6 mb-3">1.2 Google Formの仕様</h3>
        <table class="mb-6">
            <tr>
                <th width="30%">項目</th>
                <th>仕様</th>
            </tr>
            <tr>
                <td>試験名</td>
                <td>Java Silver模擬テスト①</td>
            </tr>
            <tr>
                <td>問題数</td>
                <td>50問（選択式）</td>
            </tr>
            <tr>
                <td>試験時間</td>
                <td>75分（タイマー設定）</td>
            </tr>
            <tr>
                <td>配点</td>
                <td>1問2点（合計100点満点）</td>
            </tr>
            <tr>
                <td>合格ライン</td>
                <td>70点以上（70%）</td>
            </tr>
            <tr>
                <td>テーマ</td>
                <td>プロフェッショナルなブルーベースのテーマ</td>
            </tr>
            <tr>
                <td>受験制限</td>
                <td>Googleアカウントにサインインしたユーザーのみ、1人1回のみ回答可能</td>
            </tr>
        </table>

        <h3 class="text-xl font-semibold mt-6 mb-3">1.3 受験者情報の収集</h3>
        <ul class="list-disc ml-6 mb-6">
            <li>受験者の名前（必須）</li>
            <li>メールアドレス（必須）</li>
        </ul>

        <h3 class="text-xl font-semibold mt-6 mb-3">1.4 問題構成（カテゴリ別）</h3>
        <table class="mb-6">
            <tr>
                <th>カテゴリ</th>
                <th>問題数</th>
                <th>難易度内訳</th>
            </tr>
            <tr>
                <td>基本構文と変数の宣言</td>
                <td>10問</td>
                <td>基本7問、中級2問、難問1問</td>
            </tr>
            <tr>
                <td>基本データ型と参照型</td>
                <td>10問</td>
                <td>基本7問、中級2問、難問1問</td>
            </tr>
            <tr>
                <td>演算子と式の評価</td>
                <td>10問</td>
                <td>基本7問、中級2問、難問1問</td>
            </tr>
            <tr>
                <td>制御構文（if-else, switch, for, while）</td>
                <td>10問</td>
                <td>基本7問、中級2問、難問1問</td>
            </tr>
            <tr>
                <td>配列の宣言と操作</td>
                <td>10問</td>
                <td>基本7問、中級2問、難問1問</td>
            </tr>
            <tr>
                <td>合計</td>
                <td>50問</td>
                <td>基本35問、中級10問、難問5問</td>
            </tr>
        </table>

        <h3 class="text-xl font-semibold mt-6 mb-3">1.5 スプレッドシートの構成</h3>
        <ul class="list-disc ml-6 mb-6">
            <li>メインシート：全回答データ（採点結果含む）</li>
            <li>分析シート：合否状況、平均点、最高点、最低点</li>
            <li>カテゴリ別分析：各カテゴリごとの正答率分析</li>
            <li>問題別分析：問題ごとの正答率、難易度評価</li>
            <li>個人成績表：個別受験者の成績レポート</li>
        </ul>
        
        <h2 class="text-2xl font-bold mt-8 mb-4">2. スクリプト構造</h2>
        
        <h3 class="text-xl font-semibold mt-6 mb-3">2.1 主要関数構造</h3>
        <div class="code-block">
// メイン関数
function createJavaSilverExam() {
  try {
    // フォームの作成
    const form = createExamForm();
    
    // 問題の追加
    addQuestions(form);
    
    // スプレッドシートのセットアップ
    const spreadsheet = setupSpreadsheet(form);
    
    // 分析機能のセットアップ
    setupAnalytics(spreadsheet);
    
    // 結果を返す
    return {
      formUrl: form.getPublishedUrl(),
      formEditUrl: form.getEditUrl(),
      spreadsheetUrl: spreadsheet.getUrl()
    };
  } catch (error) {
    Logger.log('エラーが発生しました: ' + error);
    return null;
  }
}

// Google Formの作成
function createExamForm() {
  // フォーム作成の実装
}

// 問題の追加
function addQuestions(form) {
  // 問題追加の実装
}

// スプレッドシートの設定
function setupSpreadsheet(form) {
  // スプレッドシート設定の実装
}

// 分析機能の設定
function setupAnalytics(sheet) {
  // 分析機能設定の実装
}
</div>

        <h3 class="text-xl font-semibold mt-6 mb-3">2.2 問題データ構造</h3>
        <div class="code-block">
// 問題データの構造
const examQuestions = [
  {
    category: 'basic-syntax', // カテゴリ
    difficulty: 'basic',      // 難易度（'basic', 'intermediate', 'advanced'）
    question: '問題文',       // 問題文
    code: 'コードスニペット（必要な場合のみ）', // オプション
    options: [               // 選択肢
      'A. 選択肢1',
      'B. 選択肢2',
      'C. 選択肢3',
      'D. 選択肢4',
      'E. 選択肢5',
    ],
    answer: 'B',             // 正解（選択肢のインデックスまたは文字）
    explanation: '解説文'     // 解説
  },
  // 他の問題...
];
</div>

        <h2 class="text-2xl font-bold mt-8 mb-4">3. 問題一覧（全50問）</h2>

        <h3 class="text-xl font-semibold mt-6 mb-3">3.1 基本構文と変数の宣言（10問）</h3>
        
        <!-- 基本問題例 -->
        <div class="question-block basic-question">
            <h4>問題1（基本）</h4>
            <p>次のコードでコンパイルエラーが発生するのはどれですか？</p>
            <ol class="list-[upper-alpha] ml-6 my-2">
                <li>int x = 5;</li>
                <li>float y = 1.5f;</li>
                <li>double z = 2.0d;</li>
                <li>long l = 10000000000;</li>
                <li>boolean b = true;</li>
            </ol>
            <p class="correct-answer">正解: D</p>
            <p class="mt-2 text-gray-700">解説: <code>long l = 10000000000;</code>はコンパイルエラーになります。この数値はint型の範囲を超えていますが、Javaは整数リテラルをデフォルトでint型と解釈するため、接尾辞Lを付ける必要があります。正しくは<code>long l = 10000000000L;</code>です。</p>
        </div>
        
        <div class="question-block basic-question">
            <h4>問題2（基本）</h4>
            <p>有効な変数名はどれですか？</p>
            <ol class="list-[upper-alpha] ml-6 my-2">
                <li>123abc</li>
                <li>_value</li>
                <li>public</li>
                <li>class</li>
                <li>break-point</li>
            </ol>
            <p class="correct-answer">正解: B</p>
            <p class="mt-2 text-gray-700">解説: 変数名は文字、ドル記号($)、アンダースコア(_)で始まる必要があります。数字で始めることはできず、予約語（public, class, breakなど）は使用できません。また、ハイフン(-)も変数名に使用できません。</p>
        </div>

        <div class="question-block basic-question">
            <h4>問題3（基本）</h4>
            <p>Javaの基本データ型（プリミティブ型）はどれですか？</p>
            <ol class="list-[upper-alpha] ml-6 my-2">
                <li>String</li>
                <li>Array</li>
                <li>Integer</li>
                <li>char</li>
                <li>Object</li>
            </ol>
            <p class="correct-answer">正解: D</p>
            <p class="mt-2 text-gray-700">解説: <code>char</code>はJavaの8つの基本データ型の1つです。<code>String</code>、<code>Array</code>、<code>Integer</code>、<code>Object</code>はすべて参照型（クラス）です。</p>
        </div>

        <div class="question-block basic-question">
            <h4>問題4（基本）</h4>
            <p>次のうち、正しい変数宣言と初期化はどれですか？</p>
            <ol class="list-[upper-alpha] ml-6 my-2">
                <li>int num = "123";</li>
                <li>string name = "Java";</li>
                <li>float price = 10.5;</li>
                <li>char letter = 'A';</li>
                <li>boolean flag = "true";</li>
            </ol>
            <p class="correct-answer">正解: D</p>
            <p class="mt-2 text-gray-700">解説: <code>char letter = 'A';</code>は正しい宣言と初期化です。char型は単一の文字を表し、シングルクォーテーション('')で囲みます。Aは文字列ではなく、文字型でStringではなく、charの変数に格納できます。</p>
        </div>
        
        <div class="question-block basic-question">
            <h4>問題5（基本）</h4>
            <p>以下のコードの出力結果は何ですか？</p>
            <div class="code-block">
int a = 10;
System.out.println(a++);
System.out.println(a);
            </div>
            <ol class="list-[upper-alpha] ml-6 my-2">
                <li>11, 11</li>
                <li>10, 11</li>
                <li>10, 10</li>
                <li>11, 10</li>
                <li>コンパイルエラー</li>
            </ol>
            <p class="correct-answer">正解: B</p>
            <p class="mt-2 text-gray-700">解説: 後置インクリメント演算子（a++）は、式の評価後に変数の値が増加します。したがって、最初の<code>println</code>では10が表示され、その後aの値が11に増加します。2回目の<code>println</code>では11が表示されます。</p>
        </div>
        
        <div class="question-block basic-question">
            <h4>問題6（基本）</h4>
            <p>次のコードの実行結果は何ですか？</p>
            <div class="code-block">
final int MAX = 100;
MAX = 200;
System.out.println(MAX);
            </div>
            <ol class="list-[upper-alpha] ml-6 my-2">
                <li>100</li>
                <li>200</li>
                <li>300</li>
                <li>コンパイルエラー</li>
                <li>実行時エラー</li>
            </ol>
            <p class="correct-answer">正解: D</p>
            <p class="mt-2 text-gray-700">解説: <code>final</code>キーワードが付いた変数は定数となり、一度初期化されると値を変更できません。したがって、<code>MAX = 200;</code>の行でコンパイルエラーが発生します。</p>
        </div>

        <div class="question-block basic-question">
            <h4>問題7（基本）</h4>
            <p>変数のスコープに関して正しい説明はどれですか？</p>
            <ol class="list-[upper-alpha] ml-6 my-2">
                <li>メソッド内で宣言された変数はクラス全体からアクセス可能</li>
                <li>クラス変数はそのクラスのインスタンスがなくてもアクセス可能</li>
                <li>ローカル変数はメソッドの外部からもアクセス可能</li>
                <li>インスタンス変数はstaticメソッドから直接アクセス可能</li>
                <li>for文内で宣言された変数はプログラム全体で使用可能</li>
            </ol>
            <p class="correct-answer">正解: B</p>
            <p class="mt-2 text-gray-700">解説: クラス変数（static変数）は、そのクラスのインスタンスを作成せずに、クラス名を使用してアクセスできます。例えば、<code>Math.PI</code>のように、Mathクラスのインスタンスを作成せずにPIにアクセスできます。</p>
        </div>
        
        <!-- 中級問題例 -->
        <div class="question-block intermediate-question">
            <h4>問題8（中級）</h4>
            <p>次のコードの実行結果は何ですか？</p>
            <div class="code-block">
public class Test {
    public static void main(String[] args) {
        int x = 10;
        int y = 20;
        {
            int y = 40;
            System.out.println(x + " " + y);
        }
        System.out.println(x + " " + y);
    }
}
            </div>
            <ol class="list-[upper-alpha] ml-6 my-2">
                <li>10 40, 10 20</li>
                <li>10 20, 10 40</li>
                <li>10 40, 10 40</li>
                <li>コンパイルエラー</li>
                <li>実行時エラー</li>
            </ol>
            <p class="correct-answer">正解: A</p>
            <p class="mt-2 text-gray-700">解説: ブロック内で宣言された変数yは、同名の外側の変数を隠します（変数のシャドウイング）。ブロック内では内側のy（値は40）が参照され、ブロックの外では外側のy（値は20）が参照されます。したがって、出力は「10 40」と「10 20」になります。</p>
        </div>
        
        <div class="question-block intermediate-question">
            <h4>問題9（中級）</h4>
            <p>次のコードの出力結果は何ですか？</p>
            <div class="code-block">
public class Test {
    static int count = 0;
    public static void main(String[] args) {
        int count = 10;
        System.out.println(count);
        System.out.println(Test.count);
    }
}
            </div>
            <ol class="list-[upper-alpha] ml-6 my-2">
                <li>0, 10</li>
                <li>10, 0</li>
                <li>10, 10</li>
                <li>0, 0</li>
                <li>コンパイルエラー</li>
            </ol>
            <p class="correct-answer">正解: B</p>
            <p class="mt-2 text-gray-700">解説: メソッド内のローカル変数<code>count</code>はクラス変数<code>count</code>と同名ですが、スコープが異なります。<code>System.out.println(count);</code>はローカル変数の10を出力し、<code>System.out.println(Test.count);</code>はクラス変数の0を出力します。</p>
        </div>
        
        <!-- 難問例 -->
        <div class="question-block advanced-question">
            <h4>問題10（難問）</h4>
            <p>次のコードの出力結果は何ですか？</p>
            <div class="code-block">
public class Test {
    public static void main(String[] args) {
        byte b = 100;
        b += 30;
        System.out.println(b);
        
        byte c = 100;
        c = c + 30;
        System.out.println(c);
    }
}
            </div>
            <ol class="list-[upper-alpha] ml-6 my-2">
                <li>130, 130</li>
                <li>-126, -126</li>
                <li>130, コンパイルエラー</li>
                <li>コンパイルエラー, 130</li>
                <li>コンパイルエラー, コンパイルエラー</li>
            </ol>
            <p class="correct-answer">正解: C</p>
            <p class="mt-2 text-gray-700">解説: 複合代入演算子（+=など）を使用する場合、自動的に結果が左辺の型にキャストされます。一方、通常の代入（c = c + 30）では、式の結果はint型と見なされ、明示的なキャストなしでbyte型に代入することはできません。したがって、<code>b += 30;</code>は有効ですが、<code>c = c + 30;</code>はコンパイルエラーになります。正しくは<code>c = (byte)(c + 30);</code>とする必要があります。</p>
        </div>

        <h3 class="text-xl font-semibold mt-6 mb-3">3.2 基本データ型と参照型（10問）</h3>
        
        <!-- 基本問題例 -->
        <div class="question-block basic-question">
            <h4>問題11（基本）</h4>
            <p>Javaの基本データ型（プリミティブ型）の特徴として正しいものはどれですか？</p>
            <ol class="list-[upper-alpha] ml-6 my-2">
                <li>オブジェクト指向の原則に従って設計されている</li>
                <li>メモリ上にはオブジェクトとして格納される</li>
                <li>nullで初期化できる</li>
                <li>固定サイズのメモリを使用する</li>
                <li>すべてのプリミティブ型はStringに変換できない</li>
            </ol>
            <p class="correct-answer">正解: D</p>
            <p class="mt-2 text-gray-700">解説: プリミティブ型は固定サイズのメモリを使用します。各プリミティブ型は、特定のバイト数のメモリを割り当てられます（例：int型は4バイト）。プリミティブ型はオブジェクトではなく、nullで初期化することもできません。</p>
        </div>

        <!-- 残りの問題も同様の形式で記述... -->

        <!-- 省略：以下同様の形式で残りの問題を記述します。各カテゴリ10問ずつ、合計50問 -->
        <!-- 基本データ型と参照型、演算子と式の評価、制御構文、配列の宣言と操作の各カテゴリから10問ずつ -->

        <h2 class="text-2xl font-bold mt-8 mb-4">4. スクリプト実装の詳細</h2>

        <h3 class="text-xl font-semibold mt-6 mb-3">4.1 Form作成関数の実装</h3>
        <div class="code-block">
function createExamForm() {
  // フォームの作成
  const form = FormApp.create('Java Silver模擬テスト①');
  
  // 説明文の設定
  form.setDescription('Java SE 11 Silver試験対策のための模擬テストです。全50問、制限時間75分、合格ラインは70点以上（100点満点）です。');
  
  // フォームの設定
  form.setIsQuiz(true)                             // クイズ形式に設定
      .setCollectEmail(true)                       // メールアドレスを収集
      .setLimitOneResponsePerUser(true)            // 1ユーザー1回の回答に制限
      .setPublishingSummary(true)                  // 回答サマリーを公開
      .setShowLinkToRespondAgain(false)            // 再回答リンクを表示しない
      .setProgressBar(true);                       // プログレスバーを表示
  
  // 受験者情報セクション
  const infoSection = form.addPageBreakItem().setTitle('受験者情報');
  
  // 名前の入力フィールド
  form.addTextItem()
      .setTitle('氏名')
      .setRequired(true);
  
  // 試験説明セクション
  const examSection = form.addPageBreakItem().setTitle('試験説明');
  examSection.setHelpText('このテストは以下のカテゴリから出題されます：\n'
                       + '• 基本構文と変数の宣言\n'
                       + '• 基本データ型と参照型\n'
                       + '• 演算子と式の評価\n'
                       + '• 制御構文（if-else, switch, for, while）\n'
                       + '• 配列の宣言と操作\n\n'
                       + '試験時間は75分、全50問（各2点）で100点満点です。70点以上で合格です。');
  
  return form;
}
</div>

        <h3 class="text-xl font-semibold mt-6 mb-3">4.2 問題追加関数の実装</h3>
        <div class="code-block">
function addQuestions(form) {
  // カテゴリごとに問題を追加
  addCategoryQuestions(form, 'basic-syntax', '基本構文と変数の宣言');
  addCategoryQuestions(form, 'data-types', '基本データ型と参照型');
  addCategoryQuestions(form, 'operators', '演算子と式の評価');
  addCategoryQuestions(form, 'control-flow', '制御構文');
  addCategoryQuestions(form, 'arrays', '配列の宣言と操作');
}

function addCategoryQuestions(form, categoryId, categoryTitle) {
  // カテゴリタイトルを追加
  form.addSectionHeaderItem().setTitle(categoryTitle);
  
  // カテゴリの問題を取得
  const questions = examQuestions.filter(q => q.category === categoryId);
  
  // 各問題をフォームに追加
  questions.forEach((q, index) => {
    // 難易度に応じた表示
    let difficultyText = '';
    if (q.difficulty === 'advanced') {
      difficultyText = '【難問】';
    } else if (q.difficulty === 'intermediate') {
      difficultyText = '【中級】';
    }
    
    // 問題文を作成（コードスニペットがあれば追加）
    let questionText = q.question;
    if (q.code) {
      questionText += '\n\n```java\n' + q.code + '\n```';
    }
    
    // 選択問題を作成
    const questionItem = form.addMultipleChoiceItem()
                              .setTitle(`問題${index + 1} ${difficultyText} ${questionText}`)
                              .setChoices(q.options.map(option => {
                                return questionItem.createChoice(option, option.startsWith(q.answer));
                              }))
                              .setPoints(2)
                              .setRequired(true);
    
    // 解説を追加
    questionItem.setFeedbackForCorrect('正解です! ' + q.explanation);
    questionItem.setFeedbackForIncorrect('不正解です。正解は ' + q.answer + ' です。' + q.explanation);
  });
}
</div>

        <h3 class="text-xl font-semibold mt-6 mb-3">4.3 スプレッドシート設定関数の実装</h3>
        <div class="code-block">
function setupSpreadsheet(form) {
  // 新しいスプレッドシートを作成
  const spreadsheet = SpreadsheetApp.create('Java Silver模擬テスト①_結果');
  
  // フォームをスプレッドシートに接続
  form.setDestination(FormApp.DestinationType.SPREADSHEET, spreadsheet.getId());
  
  // 結果シートの取得
  const responseSheet = spreadsheet.getSheets()[0];
  responseSheet.setName('回答データ');
  
  // 分析シートの作成
  const analysisSheet = spreadsheet.insertSheet('分析');
  const categorySheet = spreadsheet.insertSheet('カテゴリ別分析');
  const questionSheet = spreadsheet.insertSheet('問題別分析');
  const individualSheet = spreadsheet.insertSheet('個人成績');
  
  return spreadsheet;
}
</div>

        <h3 class="text-xl font-semibold mt-6 mb-3">4.4 分析機能設定関数の実装</h3>
        <div class="code-block">
function setupAnalytics(spreadsheet) {
  // 回答データシートから参照
  const responseSheet = spreadsheet.getSheetByName('回答データ');
  
  // 分析シートのセットアップ
  const analysisSheet = spreadsheet.getSheetByName('分析');
  setupOverallAnalysis(analysisSheet, responseSheet);
  
  // カテゴリ別分析シートのセットアップ
  const categorySheet = spreadsheet.getSheetByName('カテゴリ別分析');
  setupCategoryAnalysis(categorySheet, responseSheet);
  
  // 問題別分析シートのセットアップ
  const questionSheet = spreadsheet.getSheetByName('問題別分析');
  setupQuestionAnalysis(questionSheet, responseSheet);
  
  // 個人成績シートのセットアップ
  const individualSheet = spreadsheet.getSheetByName('個人成績');
  setupIndividualAnalysis(individualSheet, responseSheet);
}

// 全体分析のセットアップ
function setupOverallAnalysis(analysisSheet, responseSheet) {
  // ヘッダー
  analysisSheet.getRange('A1').setValue('Java Silver模擬テスト① - 全体分析');
  
  // 受験者数
  analysisSheet.getRange('A3').setValue('総受験者数:');
  analysisSheet.getRange('B3').setFormula('=COUNTA(' + responseSheet.getName() + '!B:B)-1');
  
  // 平均点
  analysisSheet.getRange('A4').setValue('平均点:');
  analysisSheet.getRange('B4').setFormula('=AVERAGE(' + responseSheet.getName() + '!<SCORE_COLUMN>:' + responseSheet.getName() + '!<SCORE_COLUMN>)');
  
  // 最高点
  analysisSheet.getRange('A5').setValue('最高点:');
  analysisSheet.getRange('B5').setFormula('=MAX(' + responseSheet.getName() + '!<SCORE_COLUMN>:' + responseSheet.getName() + '!<SCORE_COLUMN>)');
  
  // 最低点
  analysisSheet.getRange('A6').setValue('最低点:');
  analysisSheet.getRange('B6').setFormula('=MIN(' + responseSheet.getName() + '!<SCORE_COLUMN>:' + responseSheet.getName() + '!<SCORE_COLUMN>)');
  
  // 合格者数
  analysisSheet.getRange('A7').setValue('合格者数:');
  analysisSheet.getRange('B7').setFormula('=COUNTIF(' + responseSheet.getName() + '!<SCORE_COLUMN>:' + responseSheet.getName() + '!<SCORE_COLUMN>, ">=70")');
  
  // 合格率
  analysisSheet.getRange('A8').setValue('合格率:');
  analysisSheet.getRange('B8').setFormula('=B7/B3*100');
  analysisSheet.getRange('B8').setNumberFormat('0.00%');
}

// 他の分析機能のセットアップ関数も同様に実装
</div>

        <h2 class="text-2xl font-bold mt-8 mb-4">5. 実行方法とテスト</h2>
        
        <h3 class="text-xl font-semibold mt-6 mb-3">5.1 実行手順</h3>
        <ol class="list-decimal ml-6 mb-6">
            <li>Google Apps Script エディタを開く (script.google.com)</li>
            <li>新しいプロジェクトを作成</li>
            <li>提供されたコード全体をコピーしてエディタに貼り付け</li>
            <li><code>createJavaSilverExam()</code>関数を実行</li>
            <li>必要な権限を承認</li>
            <li>実行完了後、コンソールに表示されるURLを使用して作成されたフォームとスプレッドシートにアクセス</li>
        </ol>

        <h3 class="text-xl font-semibold mt-6 mb-3">5.2 スクリプトのテスト</h3>
        <ul class="list-disc ml-6 mb-6">
            <li>テスト回答を送信して、フォームが正しく機能するかを確認</li>
            <li>スプレッドシートに回答データが正しく保存されるか確認</li>
            <li>採点機能が正しく動作しているか確認</li>
            <li>分析シートが正しく計算されるか確認</li>
        </ul>

        <h2 class="text-2xl font-bold mt-8 mb-4">6. 追加機能（オプション）</h2>
        
        <h3 class="text-xl font-semibold mt-6 mb-3">6.1 自動メール通知</h3>
        <p class="mb-4">受験完了時に成績を自動メール送信する機能を追加できます。</p>

        <h3 class="text-xl font-semibold mt-6 mb-3">6.2 タイマー機能の拡張</h3>
        <p class="mb-4">残り時間の警告表示や、時間切れでの自動送信など、タイマー機能を拡張できます。</p>

        <h3 class="text-xl font-semibold mt-6 mb-3">6.3 解説ページの作成</h3>
        <p class="mb-4">すべての問題と解説を含んだ別途HTMLページを生成し、テスト終了後に提供できます。</p>

        <div class="bg-blue-50 p-4 rounded-lg mt-8 border border-blue-200">
            <h2 class="text-xl font-semibold mb-2">注意点</h2>
            <ul class="list-disc ml-6">
                <li>スクリプト実行にはGoogleアカウントの権限が必要です</li>
                <li>多数の問題を含むスクリプトは実行に時間がかかる場合があります</li>
                <li>実行制限に注意してください（Google Apps Scriptには1日あたりの実行制限があります）</li>
                <li>作成したテストフォームは必ずテスト回答で動作確認してから受験者に配布してください</li>
            </ul>
        </div>
    </div>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDrNCY1mxC73fmHCICSLtVPHKDG1XCedlNZCipQH3CgO5r2jMKW4ckkVVzumtprYhmg59qs%2BHFkED1IJktKz1cD%2Bpzw1BsTYDhs%2B1WMweIwOmUBMK3fzog9YbhmTN1qBHJCUZhI%2ByXJOh3NU9ihG%2F023fzG%2Fd3iSzxB4StwvSIAzY9eqXy%2FMWzpRAX%2FxlaWE7LWAvB86Av0aCPPzPGfDVzS1RE2f2Syg%2FGlkVS3phZlxFiy6SGbrW6ysJbLln%2BlGm84FvhlyVSKB%2FPm3Ws3rN3c7ZP6i2Fu6gAzjoTcsL8gSZnDureXwkt8R0r9kGghPwpMewP8EqBd1Ixm0J83WHSSMexLbVFh6Q9qCMKcUG1zcCEVEtJ2Gzjnbmv3ssMK8q3l9tMF2Cu7%2BanV6jMKGLkW%2F1pFDO36GnCUOqruX6c0ZrKEHwBBSWTSwZAlz0I7gJetiJBypMpVj7KqaMVVJZBCeEz8QiDy5P6XxfzORb4d7GHKEnHXwzNb3r4ZTPRpIK4T5HEf3mWmYhe3Qvdd3baZQ%3D";
        window.__genspark_locale = "ja-JP";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDrNCY1mxC73fmHCICSLtVPHKDG1XCedlNZCipQH3CgO5r2jMKW4ckkVVzumtprYhmg59qs+HFkED1IJktKz1cD+pzw1BsTYDhs+1WMweIwOmUBMK3fzog9YbhmTN1qBHJCUZhI+yXJOh3NU9ihG/023fzG/d3iSzxB4StwvSIAzY9eqXy/MWzpRAX/xlaWE7LWAvB86Av0aCPPzPGfDVzS1RE2f2Syg/GlkVS3phZlxFiy6SGbrW6ysJbLln+lGm84FvhlyVSKB/Pm3Ws3rN3c7ZP6i2Fu6gAzjoTcsL8gSZnDureXwkt8R0r9kGghPwpMewP8EqBd1Ixm0J83WHSSMexLbVFh6Q9qCMKcUG1zcCEVEtJ2Gzjnbmv3ssMK8q3l9tMF2Cu7+anV6jMKGLkW/1pFDO36GnCUOqruX6c0ZrKEHwBBSWTSwZAlz0I7gJetiJBypMpVj7KqaMVVJZBCeEz8QiDy5P6XxfzORb4d7GHKEnHXwzNb3r4ZTPRpIK4T5HEf3mWmYhe3Qvdd3baZQ=";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    