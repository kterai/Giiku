<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{_layouts/lecture}">
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      layout:decorate="~{_layouts/lecture}">
<head>
    <meta charset="UTF-8">
    <title th:text="${lecture.title}">Lecture</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism.min.css">
</head>
<body>
<div layout:fragment="pageheader" th:replace="~{_fragments/headers :: page(title=${pageTitle}, breadcrumb=${breadcrumbs})}"></div>
<body class="bg-gray-50 text-gray-900 leading-relaxed">

<div layout:fragment="pageheader"
     th:replace="~{_fragments/headers :: page(title=${pageTitle}, breadcrumb=${breadcrumbs})}"></div>

<section layout:fragment="content">
    <div class="container mb-5">
        <div class="card">
            <div class="card-body">
                <h2 th:text="${lecture.title}">Lecture Title</h2>
                <p th:text="${lecture.description}">Description</p>
                <main class="pt-32">
                    <!-- Ë¨õÁæ©„Éò„ÉÉ„ÉÄ„Éº -->
                    <header class="bg-blue-800 text-white py-4 shadow-lg">
                        <div class="container mx-auto px-4">
                            <h1 class="text-2xl md:text-3xl font-bold text-center mb-2">
                                <i class="fas fa-coffee mr-2"></i>
                                <span th:text="${lecture.title}">Ë¨õÁæ©„Çø„Ç§„Éà„É´</span>
                            </h1>
                            <p class="text-center text-blue-200 text-lg" th:text="${lecture.description}">Ë¨õÁæ©Ë™¨Êòé</p>
                            <div class="mt-3 text-center text-sm">
                    <span class="bg-blue-700 px-3 py-1 rounded-full mr-2">
                        ÊâÄË¶ÅÊôÇÈñì: <span th:text="${lecture.durationMinutes}">90</span>ÂàÜ
                    </span>
                                <span class="bg-blue-700 px-3 py-1 rounded-full mr-2"
                                      th:if="${lecture.difficultyLevel}">
                        „É¨„Éô„É´: <span th:text="${lecture.difficultyLevel}">ÂàùÁ¥ö</span>
                    </span>
                                <span class="bg-blue-700 px-3 py-1 rounded-full">
                        Ë¨õÁæ©Áï™Âè∑: <span th:text="${lecture.lectureNumber}">1</span>
                    </span>
                            </div>
                        </div>
                    </header>

                    <div class="container mx-auto px-4 py-8 max-w-6xl">

                        <!-- Â≠¶ÁøíÁõÆÊ®ô„Çª„ÇØ„Ç∑„Éß„É≥ -->
                        <section class="bg-white rounded-lg shadow-lg p-6 mb-8" th:if="${goals}">
                            <h2 class="text-2xl font-bold text-blue-800 mb-4">
                                <i class="fas fa-target mr-2"></i>Êú¨Êó•„ÅÆÂ≠¶ÁøíÁõÆÊ®ô
                            </h2>
                            <div class="grid md:grid-cols-2 gap-6">
                                <div th:each="goalCategory : ${goals}">
                                    <h3 class="font-bold mb-3" th:class="${goalCategory.type == 'knowledge' ? 'text-green-600' : 'text-blue-600'}">
                                        <span th:text="${goalCategory.icon}">üéØ</span>
                                        <span th:text="${goalCategory.title}">ÁõÆÊ®ô„Çø„Ç§„Éà„É´</span>
                                    </h3>
                                    <ul class="space-y-2">
                                        <li class="flex items-start" th:each="goal : ${goalCategory.items}">
                                            <i class="fas fa-check-circle mr-2 mt-1"
                                               th:class="${goalCategory.type == 'knowledge' ? 'text-green-500' : 'text-blue-500'}"></i>
                                            <span th:utext="${goal}">Â≠¶ÁøíÁõÆÊ®ôÈ†ÖÁõÆ</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </section>

                        <!-- „Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÉÅ„É£„Éó„Çø„Éº„Çª„ÇØ„Ç∑„Éß„É≥ -->
                        <div th:each="chapter, iterStat : ${contentChapters}" class="mb-8">
                            <section class="bg-white rounded-lg shadow-lg p-6">
                                <h2 class="text-2xl font-bold mb-4"
                                    th:class="${'text-' + (chapter.color ?: 'purple') + '-800'}"
                                    th:text="${iterStat.count + '. ' + chapter.title}">
                                    „ÉÅ„É£„Éó„Çø„Éº„Çø„Ç§„Éà„É´
                                </h2>

                                <!-- Ë¨õÂ∏´Âêë„Åë„Éù„Ç§„É≥„Éà -->
                                <div class="border-l-4 p-4 mb-6"
                                     th:if="${chapter.instructorNotes}"
                                     th:class="${'bg-' + (chapter.color ?: 'blue') + '-50 border-' + (chapter.color ?: 'blue') + '-400'}">
                                    <h3 class="font-bold mb-2" th:class="${'text-' + (chapter.color ?: 'blue') + '-700'}">
                                        <i class="fas fa-lightbulb mr-2"></i>Ë¨õÂ∏´Âêë„Åë„Éù„Ç§„É≥„Éà
                                    </h3>
                                    <p class="text-sm" th:utext="${chapter.instructorNotes}">Ë¨õÂ∏´Âêë„ÅëÊ≥®ÊÑè‰∫ãÈ†Ö</p>
                                </div>

                                <!-- „ÉÅ„É£„Éó„Çø„ÉºË™¨Êòé -->
                                <div th:if="${chapter.description}" class="mb-6">
                                    <p th:utext="${chapter.description}">„ÉÅ„É£„Éó„Çø„ÉºË™¨Êòé</p>
                                </div>

                                <!-- „Ç≥„É≥„ÉÜ„É≥„ÉÑ„Éñ„É≠„ÉÉ„ÇØ -->
                                <div th:each="block : ${chapter.contentBlocks}" class="mb-6">

                                    <!-- „ÉÜ„Éº„Éñ„É´ÂΩ¢Âºè„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
                                    <div th:if="${block.type == 'table'}" class="overflow-x-auto mb-6">
                                        <table class="w-full border-collapse border border-gray-300 bg-white">
                                            <thead>
                                            <tr class="bg-gray-100">
                                                <th th:each="header : ${block.headers}"
                                                    class="border border-gray-300 p-3 text-left"
                                                    th:text="${header}">„Éò„ÉÉ„ÉÄ„Éº</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr th:each="row, rowStat : ${block.rows}"
                                                th:class="${rowStat.odd ? 'bg-gray-50' : ''}">
                                                <td th:each="cell : ${row}"
                                                    class="border border-gray-300 p-3"
                                                    th:utext="${cell}">„Çª„É´ÂÜÖÂÆπ</td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                    <!-- „Çπ„ÉÜ„ÉÉ„ÉóÂΩ¢Âºè„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
                                    <div th:if="${block.type == 'steps'}" class="space-y-6">
                                        <div th:each="step, stepStat : ${block.steps}"
                                             class="border border-gray-200 rounded-lg p-4">
                                            <h4 class="font-bold mb-3" th:class="${'text-' + (step.color ?: 'blue') + '-600'}">
                                    <span class="px-2 py-1 rounded-full text-sm mr-2"
                                          th:class="${'bg-' + (step.color ?: 'blue') + '-100'}">
                                        <span th:text="${step.stepNumber ?: ('ÊâãÈ†Ü' + (stepStat.count))}">Step 1</span>
                                    </span>
                                                <span th:text="${step.title}">„Çπ„ÉÜ„ÉÉ„Éó„Çø„Ç§„Éà„É´</span>
                                            </h4>

                                            <div th:if="${step.description}"
                                                 class="rounded-lg p-4 mb-4"
                                                 th:class="${'bg-' + (step.color ?: 'blue') + '-50'}">
                                                <p class="text-sm" th:utext="${step.description}">„Çπ„ÉÜ„ÉÉ„ÉóË™¨Êòé</p>
                                            </div>

                                            <!-- „Çπ„ÉÜ„ÉÉ„ÉóË©≥Á¥∞ -->
                                            <div th:if="${step.details}">
                                                <ol class="space-y-2 text-sm">
                                                    <li th:each="detail, detailStat : ${step.details}"
                                                        class="flex items-start">
                                            <span class="flex-shrink-0 px-2 py-1 rounded-full text-xs font-medium mr-3 mt-0.5"
                                                  th:class="${'bg-' + (step.color ?: 'blue') + '-100 text-' + (step.color ?: 'blue') + '-800'}"
                                                  th:text="${detailStat.count}">1</span>
                                                        <span th:utext="${detail}">Ë©≥Á¥∞ÂÜÖÂÆπ</span>
                                                    </li>
                                                </ol>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- „Ç≥„Éº„Éâ„Éñ„É≠„ÉÉ„ÇØ -->
                                    <div th:if="${block.type == 'code'}" class="code-highlight rounded-lg p-4 mb-4 bg-gray-900">
                            <pre class="text-white overflow-x-auto"><code th:class="${'language-' + (block.language ?: 'java')}"
                                                                          th:text="${block.code}">„Ç≥„Éº„ÉâÂÜÖÂÆπ</code></pre>
                                    </div>

                                    <!-- Ë™¨Êòé„Éú„ÉÉ„ÇØ„Çπ -->
                                    <div th:if="${block.type == 'explanation'}"
                                         class="rounded-lg p-4"
                                         th:class="${'bg-' + (block.color ?: 'yellow') + '-50 border border-' + (block.color ?: 'yellow') + '-200'}">
                                        <h4 class="font-bold mb-2"
                                            th:class="${'text-' + (block.color ?: 'yellow') + '-800'}">
                                            <i th:class="${block.icon ?: 'fas fa-quote-left'}" class="mr-2"></i>
                                            <span th:text="${block.title}">Ë™¨Êòé„Çø„Ç§„Éà„É´</span>
                                        </h4>
                                        <p th:utext="${block.content}">Ë™¨ÊòéÂÜÖÂÆπ</p>
                                    </div>

                                    <!-- „É™„Çπ„ÉàÂΩ¢Âºè -->
                                    <div th:if="${block.type == 'list'}" class="mb-4">
                                        <h4 th:if="${block.title}" class="font-semibold mb-2" th:text="${block.title}">„É™„Çπ„Éà„Çø„Ç§„Éà„É´</h4>
                                        <ul class="space-y-1" th:class="${block.listStyle ?: 'text-sm'}">
                                            <li th:each="item : ${block.items}" th:utext="${item}">„É™„Çπ„ÉàÈ†ÖÁõÆ</li>
                                        </ul>
                                    </div>

                                    <!-- „Ç¢„É©„Éº„Éà„Éú„ÉÉ„ÇØ„Çπ -->
                                    <div th:if="${block.type == 'alert'}"
                                         class="rounded-lg p-4 border-l-4"
                                         th:class="${'bg-' + (block.alertType ?: 'info') + '-50 border-' + (block.alertType ?: 'info') + '-400'}">
                                        <h4 class="font-bold mb-2" th:class="${'text-' + (block.alertType ?: 'info') + '-700'}">
                                            <i th:class="${block.icon ?: 'fas fa-info-circle'}" class="mr-2"></i>
                                            <span th:text="${block.title}">„Ç¢„É©„Éº„Éà„Çø„Ç§„Éà„É´</span>
                                        </h4>
                                        <p class="text-sm" th:utext="${block.content}">„Ç¢„É©„Éº„ÉàÂÜÖÂÆπ</p>
                                    </div>
                                </div>

                                <!-- „Éà„É©„Éñ„É´„Ç∑„É•„Éº„ÉÜ„Ç£„É≥„Ç∞ -->
                                <div th:if="${chapter.troubleshooting}"
                                     class="mt-6 bg-orange-50 border-l-4 border-orange-400 p-4 rounded">
                                    <h4 class="font-bold text-orange-700 mb-3">
                                        <i class="fas fa-wrench mr-2"></i>„Çà„Åè„ÅÇ„Çã„Éà„É©„Éñ„É´„Å®ÂØæÂá¶Ê≥ï
                                    </h4>
                                    <div class="overflow-x-auto">
                                        <table class="w-full border-collapse border border-gray-300 text-sm">
                                            <thead>
                                            <tr class="bg-orange-100">
                                                <th class="border border-gray-300 p-2 text-left">„Ç®„É©„ÉºÁóáÁä∂</th>
                                                <th class="border border-gray-300 p-2 text-left">ÂéüÂõ†</th>
                                                <th class="border border-gray-300 p-2 text-left">ÂØæÂá¶Ê≥ï</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr th:each="trouble, troubleStat : ${chapter.troubleshooting}"
                                                th:class="${troubleStat.odd ? 'bg-gray-50' : ''}">
                                                <td class="border border-gray-300 p-2" th:text="${trouble.symptom}">„Ç®„É©„ÉºÁóáÁä∂</td>
                                                <td class="border border-gray-300 p-2" th:text="${trouble.cause}">ÂéüÂõ†</td>
                                                <td class="border border-gray-300 p-2" th:utext="${trouble.solution}">ÂØæÂá¶Ê≥ï</td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </section>
                        </div>

                        <!-- ÊºîÁøíÂïèÈ°å„Çª„ÇØ„Ç∑„Éß„É≥ -->
                        <section th:if="${exercises}" class="bg-white rounded-lg shadow-lg p-6 mb-8">
                            <h2 class="text-2xl font-bold text-indigo-800 mb-4">
                                <i class="fas fa-dumbbell mr-2"></i>ÊºîÁøíÂïèÈ°å
                            </h2>

                            <div th:each="exercise, exStat : ${exercises}" class="border border-gray-200 rounded-lg p-4 mb-6">
                                <h3 class="font-bold text-blue-600 mb-3"
                                    th:text="${'ÊºîÁøíÂïèÈ°å' + (exStat.count) + ': ' + exercise.title}">ÊºîÁøíÂïèÈ°å„Çø„Ç§„Éà„É´</h3>
                                <p class="mb-3" th:utext="${exercise.description}">ÂïèÈ°åË™¨Êòé</p>

                                <ol th:if="${exercise.questions}" class="space-y-2 mb-4">
                                    <li th:each="question, qStat : ${exercise.questions}"
                                        th:text="${(qStat.count) + '. ' + question}">Ë≥™ÂïèÂÜÖÂÆπ</li>
                                </ol>

                                <button th:onclick="'toggleAnswer(\'answer' + ${exStat.count} + '\')'"
                                        class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded transition-colors">
                                    <i class="fas fa-eye mr-2"></i>ÂõûÁ≠î‰æã„ÇíË°®Á§∫
                                </button>

                                <div sec:authorize="hasAnyRole('ADMIN','INSTRUCTOR')"
                                     th:id="'answer' + ${exStat.count}"
                                     class="answer-content mt-4 bg-blue-50 border-l-4 border-blue-400 p-4 rounded"
                                     style="display: none;">
                                    <h4 class="font-semibold mb-2">ÂõûÁ≠î‰æãÔºö</h4>
                                    <div class="space-y-3 text-sm">
                                        <div th:each="answer : ${exercise.answers}">
                                            <p class="font-medium" th:text="${answer.question}">Ë≥™Âïè</p>
                                            <p th:utext="${answer.answer}">ÂõûÁ≠î</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- ËøΩÂä†„É™„ÇΩ„Éº„Çπ -->
                        <section th:if="${additionalResources}" class="bg-white rounded-lg shadow-lg p-6 mb-8">
                            <h2 class="text-2xl font-bold text-purple-800 mb-4">
                                <i class="fas fa-link mr-2"></i>ËøΩÂä†Â≠¶Áøí„É™„ÇΩ„Éº„Çπ
                            </h2>
                            <div class="grid md:grid-cols-2 gap-4">
                                <div th:each="resource : ${additionalResources}">
                                    <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                                        <h4 class="font-semibold mb-2" th:text="${resource.title}">„É™„ÇΩ„Éº„Çπ„Çø„Ç§„Éà„É´</h4>
                                        <p class="text-sm text-gray-600 mb-2" th:text="${resource.description}">Ë™¨Êòé</p>
                                        <a th:href="${resource.url}" target="_blank"
                                           class="text-blue-600 hover:text-blue-800 text-sm">
                                            <i class="fas fa-external-link-alt mr-1"></i>
                                            <span th:text="${resource.linkText ?: '„É™„É≥„ÇØ„ÇíÈñã„Åè'}">„É™„É≥„ÇØ„ÉÜ„Ç≠„Çπ„Éà</span>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ -->
                        <section class="flex justify-between items-center bg-white rounded-lg shadow-lg p-6">
                            <div>
                                <a th:if="${previousLecture}"
                                   th:href="@{/lecture/{id}(id=${previousLecture.id})}"
                                   class="inline-flex items-center px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors">
                                    <i class="fas fa-arrow-left mr-2"></i>
                                    Ââç„ÅÆË¨õÁæ©: <span th:text="${previousLecture.title}">Ââç„ÅÆË¨õÁæ©</span>
                                </a>
                            </div>
                            <div>
                                <a th:if="${nextLecture}"
                                   th:href="@{/lecture/{id}(id=${nextLecture.id})}"
                                   class="inline-flex items-center px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors">
                                    Ê¨°„ÅÆË¨õÁæ©: <span th:text="${nextLecture.title}">Ê¨°„ÅÆË¨õÁæ©</span>
                                    <i class="fas fa-arrow-right ml-2"></i>
                                </a>
                            </div>
                        </section>
                    </div>
                </main>

                <!-- JavaScript -->
                <script>
                    function toggleAnswer(answerId) {
                        const answerElement = document.getElementById(answerId);
                        if (answerElement) {
                            const isHidden = answerElement.style.display === 'none';
                            answerElement.style.display = isHidden ? 'block' : 'none';

                            // „Éú„Çø„É≥„ÉÜ„Ç≠„Çπ„Éà„ÇíÂ§âÊõ¥
                            const button = document.querySelector(`[onclick*="${answerId}"]`);
                            if (button) {
                                const icon = button.querySelector('i');
                                const text = button.querySelector('i + *') || button.childNodes[1];
                                if (isHidden) {
                                    icon.className = 'fas fa-eye-slash mr-2';
                                    text.textContent = 'ÂõûÁ≠î‰æã„ÇíÈùûË°®Á§∫';
                                } else {
                                    icon.className = 'fas fa-eye mr-2';
                                    text.textContent = 'ÂõûÁ≠î‰æã„ÇíË°®Á§∫';
                                }
                            }
                        }
                    }

                    // „Ç≥„Éº„Éâ„Éñ„É≠„ÉÉ„ÇØ„ÅÆÊßãÊñá„Éè„Ç§„É©„Ç§„Éà
                    document.addEventListener('DOMContentLoaded', function() {
                        // Prism.js„Åå„É≠„Éº„Éâ„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅÆ„ÅøÂÆüË°å
                        if (typeof Prism !== 'undefined') {
                            Prism.highlightAll();
                        }
                    });
                </script>

                <!-- Syntax Highlighting -->
                <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-java.min.js"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-sql.min.js"></script>
</section>
</body>
</html>
